import{z as Bn,m as j,b as Lt,A as Gt,B as D,_ as ht,o as A,h as ot,i as nt,c as R,F as jt,r as ae,t as be,L as Yr,C as Ce,D as le,E as Fn,e as G,k as Xr,f as O,G as $e,u as ee,H as zt,I as vt,q as Ae,J as Uo,d as Q,j as Qe,n as At,s as wt,x as qo,y as Ht,T as Wo,K as Yo,M as Kr,N as Fe,O as Xo,P as Ko,Q as jr,R as Zn,S as Ne,p as Qr,U as fn,l as jo,V as Qo,a as Jo,W as wr,X as br,Y as ta}from"./index-BLlMk6Ru.js";import{T as ea}from"./TheVideo-JWRRj9Rw.js";import{I as Mn}from"./InputButton-CxrAPq47.js";import{T as na}from"./TheHeader-DmDNvKd8.js";var ra={value:()=>{}};function hn(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new We(n)}function We(t){this._=t}function ia(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}We.prototype=hn.prototype={constructor:We,on:function(t,e){var n=this._,r=ia(t+"",n),i,o=-1,a=r.length;if(arguments.length<2){for(;++o<a;)if((i=(t=r[o]).type)&&(i=oa(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++o<a;)if(i=(t=r[o]).type)n[i]=Cr(n[i],t.name,e);else if(e==null)for(i in n)n[i]=Cr(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new We(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,o;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=this._[t],r=0,i=o.length;r<i;++r)o[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};function oa(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function Cr(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=ra,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var Nn="http://www.w3.org/1999/xhtml";const Lr={svg:"http://www.w3.org/2000/svg",xhtml:Nn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function dn(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),Lr.hasOwnProperty(e)?{space:Lr[e],local:t}:t}function aa(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Nn&&e.documentElement.namespaceURI===Nn?e.createElement(t):e.createElementNS(n,t)}}function sa(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Jr(t){var e=dn(t);return(e.local?sa:aa)(e)}function ua(){}function Hn(t){return t==null?ua:function(){return this.querySelector(t)}}function la(t){typeof t!="function"&&(t=Hn(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],a=o.length,s=r[i]=new Array(a),f,u,l=0;l<a;++l)(f=o[l])&&(u=t.call(f,f.__data__,l,o))&&("__data__"in f&&(u.__data__=f.__data__),s[l]=u);return new yt(r,this._parents)}function ca(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function fa(){return[]}function ti(t){return t==null?fa:function(){return this.querySelectorAll(t)}}function ha(t){return function(){return ca(t.apply(this,arguments))}}function da(t){typeof t=="function"?t=ha(t):t=ti(t);for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var a=e[o],s=a.length,f,u=0;u<s;++u)(f=a[u])&&(r.push(t.call(f,f.__data__,u,a)),i.push(f));return new yt(r,i)}function ei(t){return function(){return this.matches(t)}}function ni(t){return function(e){return e.matches(t)}}var pa=Array.prototype.find;function ga(t){return function(){return pa.call(this.children,t)}}function va(){return this.firstElementChild}function ya(t){return this.select(t==null?va:ga(typeof t=="function"?t:ni(t)))}var ma=Array.prototype.filter;function _a(){return Array.from(this.children)}function xa(t){return function(){return ma.call(this.children,t)}}function wa(t){return this.selectAll(t==null?_a:xa(typeof t=="function"?t:ni(t)))}function ba(t){typeof t!="function"&&(t=ei(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],a=o.length,s=r[i]=[],f,u=0;u<a;++u)(f=o[u])&&t.call(f,f.__data__,u,o)&&s.push(f);return new yt(r,this._parents)}function ri(t){return new Array(t.length)}function Ca(){return new yt(this._enter||this._groups.map(ri),this._parents)}function Je(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Je.prototype={constructor:Je,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function La(t){return function(){return t}}function Ma(t,e,n,r,i,o){for(var a=0,s,f=e.length,u=o.length;a<u;++a)(s=e[a])?(s.__data__=o[a],r[a]=s):n[a]=new Je(t,o[a]);for(;a<f;++a)(s=e[a])&&(i[a]=s)}function Sa(t,e,n,r,i,o,a){var s,f,u=new Map,l=e.length,h=o.length,d=new Array(l),p;for(s=0;s<l;++s)(f=e[s])&&(d[s]=p=a.call(f,f.__data__,s,e)+"",u.has(p)?i[s]=f:u.set(p,f));for(s=0;s<h;++s)p=a.call(t,o[s],s,o)+"",(f=u.get(p))?(r[s]=f,f.__data__=o[s],u.delete(p)):n[s]=new Je(t,o[s]);for(s=0;s<l;++s)(f=e[s])&&u.get(d[s])===f&&(i[s]=f)}function $a(t){return t.__data__}function Aa(t,e){if(!arguments.length)return Array.from(this,$a);var n=e?Sa:Ma,r=this._parents,i=this._groups;typeof t!="function"&&(t=La(t));for(var o=i.length,a=new Array(o),s=new Array(o),f=new Array(o),u=0;u<o;++u){var l=r[u],h=i[u],d=h.length,p=Na(t.call(l,l&&l.__data__,u,r)),x=p.length,v=s[u]=new Array(x),m=a[u]=new Array(x),y=f[u]=new Array(d);n(l,h,v,m,y,p,e);for(var L=0,S=0,M,B;L<x;++L)if(M=v[L]){for(L>=S&&(S=L+1);!(B=m[S])&&++S<x;);M._next=B||null}}return a=new yt(a,r),a._enter=s,a._exit=f,a}function Na(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function ka(){return new yt(this._exit||this._groups.map(ri),this._parents)}function Ta(t,e,n){var r=this.enter(),i=this,o=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?o.remove():n(o),r&&i?r.merge(i).order():i}function Ea(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,o=r.length,a=Math.min(i,o),s=new Array(i),f=0;f<a;++f)for(var u=n[f],l=r[f],h=u.length,d=s[f]=new Array(h),p,x=0;x<h;++x)(p=u[x]||l[x])&&(d[x]=p);for(;f<i;++f)s[f]=n[f];return new yt(s,this._parents)}function Ia(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,o=r[i],a;--i>=0;)(a=r[i])&&(o&&a.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(a,o),o=a);return this}function za(t){t||(t=Da);function e(h,d){return h&&d?t(h.__data__,d.__data__):!h-!d}for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a=n[o],s=a.length,f=i[o]=new Array(s),u,l=0;l<s;++l)(u=a[l])&&(f[l]=u);f.sort(e)}return new yt(i,this._parents).order()}function Da(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Pa(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Oa(){return Array.from(this)}function Ra(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null}function Ba(){let t=0;for(const e of this)++t;return t}function Fa(){return!this.node()}function Za(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],o=0,a=i.length,s;o<a;++o)(s=i[o])&&t.call(s,s.__data__,o,i);return this}function Ha(t){return function(){this.removeAttribute(t)}}function Ga(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Va(t,e){return function(){this.setAttribute(t,e)}}function Ua(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function qa(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function Wa(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Ya(t,e){var n=dn(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?Ga:Ha:typeof e=="function"?n.local?Wa:qa:n.local?Ua:Va)(n,e))}function ii(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Xa(t){return function(){this.style.removeProperty(t)}}function Ka(t,e,n){return function(){this.style.setProperty(t,e,n)}}function ja(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function Qa(t,e,n){return arguments.length>1?this.each((e==null?Xa:typeof e=="function"?ja:Ka)(t,e,n??"")):se(this.node(),t)}function se(t,e){return t.style.getPropertyValue(e)||ii(t).getComputedStyle(t,null).getPropertyValue(e)}function Ja(t){return function(){delete this[t]}}function ts(t,e){return function(){this[t]=e}}function es(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function ns(t,e){return arguments.length>1?this.each((e==null?Ja:typeof e=="function"?es:ts)(t,e)):this.node()[t]}function oi(t){return t.trim().split(/^|\s+/)}function Gn(t){return t.classList||new ai(t)}function ai(t){this._node=t,this._names=oi(t.getAttribute("class")||"")}ai.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function si(t,e){for(var n=Gn(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function ui(t,e){for(var n=Gn(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function rs(t){return function(){si(this,t)}}function is(t){return function(){ui(this,t)}}function os(t,e){return function(){(e.apply(this,arguments)?si:ui)(this,t)}}function as(t,e){var n=oi(t+"");if(arguments.length<2){for(var r=Gn(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?os:e?rs:is)(n,e))}function ss(){this.textContent=""}function us(t){return function(){this.textContent=t}}function ls(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function cs(t){return arguments.length?this.each(t==null?ss:(typeof t=="function"?ls:us)(t)):this.node().textContent}function fs(){this.innerHTML=""}function hs(t){return function(){this.innerHTML=t}}function ds(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function ps(t){return arguments.length?this.each(t==null?fs:(typeof t=="function"?ds:hs)(t)):this.node().innerHTML}function gs(){this.nextSibling&&this.parentNode.appendChild(this)}function vs(){return this.each(gs)}function ys(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ms(){return this.each(ys)}function _s(t){var e=typeof t=="function"?t:Jr(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function xs(){return null}function ws(t,e){var n=typeof t=="function"?t:Jr(t),r=e==null?xs:typeof e=="function"?e:Hn(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function bs(){var t=this.parentNode;t&&t.removeChild(this)}function Cs(){return this.each(bs)}function Ls(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Ms(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Ss(t){return this.select(t?Ms:Ls)}function $s(t){return arguments.length?this.property("__data__",t):this.node().__data__}function As(t){return function(e){t.call(this,e,this.__data__)}}function Ns(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function ks(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,o;n<i;++n)o=e[n],(!t.type||o.type===t.type)&&o.name===t.name?this.removeEventListener(o.type,o.listener,o.options):e[++r]=o;++r?e.length=r:delete this.__on}}}function Ts(t,e,n){return function(){var r=this.__on,i,o=As(e);if(r){for(var a=0,s=r.length;a<s;++a)if((i=r[a]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),i.value=e;return}}this.addEventListener(t.type,o,n),i={type:t.type,name:t.name,value:e,listener:o,options:n},r?r.push(i):this.__on=[i]}}function Es(t,e,n){var r=Ns(t+""),i,o=r.length,a;if(arguments.length<2){var s=this.node().__on;if(s){for(var f=0,u=s.length,l;f<u;++f)for(i=0,l=s[f];i<o;++i)if((a=r[i]).type===l.type&&a.name===l.name)return l.value}return}for(s=e?Ts:ks,i=0;i<o;++i)this.each(s(r[i],e,n));return this}function li(t,e,n){var r=ii(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Is(t,e){return function(){return li(this,t,e)}}function zs(t,e){return function(){return li(this,t,e.apply(this,arguments))}}function Ds(t,e){return this.each((typeof e=="function"?zs:Is)(t,e))}function*Ps(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length,a;i<o;++i)(a=r[i])&&(yield a)}var ci=[null];function yt(t,e){this._groups=t,this._parents=e}function ke(){return new yt([[document.documentElement]],ci)}function Os(){return this}yt.prototype=ke.prototype={constructor:yt,select:la,selectAll:da,selectChild:ya,selectChildren:wa,filter:ba,data:Aa,enter:Ca,exit:ka,join:Ta,merge:Ea,selection:Os,order:Ia,sort:za,call:Pa,nodes:Oa,node:Ra,size:Ba,empty:Fa,each:Za,attr:Ya,style:Qa,property:ns,classed:as,text:cs,html:ps,raise:vs,lower:ms,append:_s,insert:ws,remove:Cs,clone:Ss,datum:$s,on:Es,dispatch:Ds,[Symbol.iterator]:Ps};function Ft(t){return typeof t=="string"?new yt([[document.querySelector(t)]],[document.documentElement]):new yt([[t]],ci)}function Rs(t){let e;for(;e=t.sourceEvent;)t=e;return t}function Xt(t,e){if(t=Rs(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}const kn={capture:!0,passive:!1};function Tn(t){t.preventDefault(),t.stopImmediatePropagation()}function Bs(t){var e=t.document.documentElement,n=Ft(t).on("dragstart.drag",Tn,kn);"onselectstart"in e?n.on("selectstart.drag",Tn,kn):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Fs(t,e){var n=t.document.documentElement,r=Ft(t).on("dragstart.drag",null);e&&(r.on("click.drag",Tn,kn),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function Vn(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function fi(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Te(){}var Le=.7,tn=1/Le,oe="\\s*([+-]?\\d+)\\s*",Me="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Nt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Zs=/^#([0-9a-f]{3,8})$/,Hs=new RegExp(`^rgb\\(${oe},${oe},${oe}\\)$`),Gs=new RegExp(`^rgb\\(${Nt},${Nt},${Nt}\\)$`),Vs=new RegExp(`^rgba\\(${oe},${oe},${oe},${Me}\\)$`),Us=new RegExp(`^rgba\\(${Nt},${Nt},${Nt},${Me}\\)$`),qs=new RegExp(`^hsl\\(${Me},${Nt},${Nt}\\)$`),Ws=new RegExp(`^hsla\\(${Me},${Nt},${Nt},${Me}\\)$`),Mr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Vn(Te,Jt,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Sr,formatHex:Sr,formatHex8:Ys,formatHsl:Xs,formatRgb:$r,toString:$r});function Sr(){return this.rgb().formatHex()}function Ys(){return this.rgb().formatHex8()}function Xs(){return hi(this).formatHsl()}function $r(){return this.rgb().formatRgb()}function Jt(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Zs.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?Ar(e):n===3?new pt(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Ze(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Ze(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Hs.exec(t))?new pt(e[1],e[2],e[3],1):(e=Gs.exec(t))?new pt(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Vs.exec(t))?Ze(e[1],e[2],e[3],e[4]):(e=Us.exec(t))?Ze(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=qs.exec(t))?Tr(e[1],e[2]/100,e[3]/100,1):(e=Ws.exec(t))?Tr(e[1],e[2]/100,e[3]/100,e[4]):Mr.hasOwnProperty(t)?Ar(Mr[t]):t==="transparent"?new pt(NaN,NaN,NaN,0):null}function Ar(t){return new pt(t>>16&255,t>>8&255,t&255,1)}function Ze(t,e,n,r){return r<=0&&(t=e=n=NaN),new pt(t,e,n,r)}function Ks(t){return t instanceof Te||(t=Jt(t)),t?(t=t.rgb(),new pt(t.r,t.g,t.b,t.opacity)):new pt}function En(t,e,n,r){return arguments.length===1?Ks(t):new pt(t,e,n,r??1)}function pt(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}Vn(pt,En,fi(Te,{brighter(t){return t=t==null?tn:Math.pow(tn,t),new pt(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Le:Math.pow(Le,t),new pt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new pt(Qt(this.r),Qt(this.g),Qt(this.b),en(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Nr,formatHex:Nr,formatHex8:js,formatRgb:kr,toString:kr}));function Nr(){return`#${Kt(this.r)}${Kt(this.g)}${Kt(this.b)}`}function js(){return`#${Kt(this.r)}${Kt(this.g)}${Kt(this.b)}${Kt((isNaN(this.opacity)?1:this.opacity)*255)}`}function kr(){const t=en(this.opacity);return`${t===1?"rgb(":"rgba("}${Qt(this.r)}, ${Qt(this.g)}, ${Qt(this.b)}${t===1?")":`, ${t})`}`}function en(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Qt(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Kt(t){return t=Qt(t),(t<16?"0":"")+t.toString(16)}function Tr(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new bt(t,e,n,r)}function hi(t){if(t instanceof bt)return new bt(t.h,t.s,t.l,t.opacity);if(t instanceof Te||(t=Jt(t)),!t)return new bt;if(t instanceof bt)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,s=o-i,f=(o+i)/2;return s?(e===o?a=(n-r)/s+(n<r)*6:n===o?a=(r-e)/s+2:a=(e-n)/s+4,s/=f<.5?o+i:2-o-i,a*=60):s=f>0&&f<1?0:a,new bt(a,s,f,t.opacity)}function Qs(t,e,n,r){return arguments.length===1?hi(t):new bt(t,e,n,r??1)}function bt(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}Vn(bt,Qs,fi(Te,{brighter(t){return t=t==null?tn:Math.pow(tn,t),new bt(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Le:Math.pow(Le,t),new bt(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new pt(Sn(t>=240?t-240:t+120,i,r),Sn(t,i,r),Sn(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new bt(Er(this.h),He(this.s),He(this.l),en(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=en(this.opacity);return`${t===1?"hsl(":"hsla("}${Er(this.h)}, ${He(this.s)*100}%, ${He(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Er(t){return t=(t||0)%360,t<0?t+360:t}function He(t){return Math.max(0,Math.min(1,t||0))}function Sn(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const Un=t=>()=>t;function Js(t,e){return function(n){return t+n*e}}function tu(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function eu(t){return(t=+t)==1?di:function(e,n){return n-e?tu(e,n,t):Un(isNaN(e)?n:e)}}function di(t,e){var n=e-t;return n?Js(t,n):Un(isNaN(t)?e:t)}const nn=function t(e){var n=eu(e);function r(i,o){var a=n((i=En(i)).r,(o=En(o)).r),s=n(i.g,o.g),f=n(i.b,o.b),u=di(i.opacity,o.opacity);return function(l){return i.r=a(l),i.g=s(l),i.b=f(l),i.opacity=u(l),i+""}}return r.gamma=t,r}(1);function nu(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(o){for(i=0;i<n;++i)r[i]=t[i]*(1-o)+e[i]*o;return r}}function ru(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function iu(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),o=new Array(n),a;for(a=0;a<r;++a)i[a]=rn(t[a],e[a]);for(;a<n;++a)o[a]=e[a];return function(s){for(a=0;a<r;++a)o[a]=i[a](s);return o}}function ou(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function $t(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function au(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=rn(t[i],e[i]):r[i]=e[i];return function(o){for(i in n)r[i]=n[i](o);return r}}var In=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,$n=new RegExp(In.source,"g");function su(t){return function(){return t}}function uu(t){return function(e){return t(e)+""}}function pi(t,e){var n=In.lastIndex=$n.lastIndex=0,r,i,o,a=-1,s=[],f=[];for(t=t+"",e=e+"";(r=In.exec(t))&&(i=$n.exec(e));)(o=i.index)>n&&(o=e.slice(n,o),s[a]?s[a]+=o:s[++a]=o),(r=r[0])===(i=i[0])?s[a]?s[a]+=i:s[++a]=i:(s[++a]=null,f.push({i:a,x:$t(r,i)})),n=$n.lastIndex;return n<e.length&&(o=e.slice(n),s[a]?s[a]+=o:s[++a]=o),s.length<2?f[0]?uu(f[0].x):su(e):(e=f.length,function(u){for(var l=0,h;l<e;++l)s[(h=f[l]).i]=h.x(u);return s.join("")})}function rn(t,e){var n=typeof e,r;return e==null||n==="boolean"?Un(e):(n==="number"?$t:n==="string"?(r=Jt(e))?(e=r,nn):pi:e instanceof Jt?nn:e instanceof Date?ou:ru(e)?nu:Array.isArray(e)?iu:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?au:$t)(t,e)}var Ir=180/Math.PI,zn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function gi(t,e,n,r,i,o){var a,s,f;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(f=t*n+e*r)&&(n-=t*f,r-=e*f),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,f/=s),t*r<e*n&&(t=-t,e=-e,f=-f,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*Ir,skewX:Math.atan(f)*Ir,scaleX:a,scaleY:s}}var Ge;function lu(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?zn:gi(e.a,e.b,e.c,e.d,e.e,e.f)}function cu(t){return t==null||(Ge||(Ge=document.createElementNS("http://www.w3.org/2000/svg","g")),Ge.setAttribute("transform",t),!(t=Ge.transform.baseVal.consolidate()))?zn:(t=t.matrix,gi(t.a,t.b,t.c,t.d,t.e,t.f))}function vi(t,e,n,r){function i(u){return u.length?u.pop()+" ":""}function o(u,l,h,d,p,x){if(u!==h||l!==d){var v=p.push("translate(",null,e,null,n);x.push({i:v-4,x:$t(u,h)},{i:v-2,x:$t(l,d)})}else(h||d)&&p.push("translate("+h+e+d+n)}function a(u,l,h,d){u!==l?(u-l>180?l+=360:l-u>180&&(u+=360),d.push({i:h.push(i(h)+"rotate(",null,r)-2,x:$t(u,l)})):l&&h.push(i(h)+"rotate("+l+r)}function s(u,l,h,d){u!==l?d.push({i:h.push(i(h)+"skewX(",null,r)-2,x:$t(u,l)}):l&&h.push(i(h)+"skewX("+l+r)}function f(u,l,h,d,p,x){if(u!==h||l!==d){var v=p.push(i(p)+"scale(",null,",",null,")");x.push({i:v-4,x:$t(u,h)},{i:v-2,x:$t(l,d)})}else(h!==1||d!==1)&&p.push(i(p)+"scale("+h+","+d+")")}return function(u,l){var h=[],d=[];return u=t(u),l=t(l),o(u.translateX,u.translateY,l.translateX,l.translateY,h,d),a(u.rotate,l.rotate,h,d),s(u.skewX,l.skewX,h,d),f(u.scaleX,u.scaleY,l.scaleX,l.scaleY,h,d),u=l=null,function(p){for(var x=-1,v=d.length,m;++x<v;)h[(m=d[x]).i]=m.x(p);return h.join("")}}}var fu=vi(lu,"px, ","px)","deg)"),hu=vi(cu,", ",")",")"),du=1e-12;function zr(t){return((t=Math.exp(t))+1/t)/2}function pu(t){return((t=Math.exp(t))-1/t)/2}function gu(t){return((t=Math.exp(2*t))-1)/(t+1)}const vu=function t(e,n,r){function i(o,a){var s=o[0],f=o[1],u=o[2],l=a[0],h=a[1],d=a[2],p=l-s,x=h-f,v=p*p+x*x,m,y;if(v<du)y=Math.log(d/u)/e,m=function(K){return[s+K*p,f+K*x,u*Math.exp(e*K*y)]};else{var L=Math.sqrt(v),S=(d*d-u*u+r*v)/(2*u*n*L),M=(d*d-u*u-r*v)/(2*d*n*L),B=Math.log(Math.sqrt(S*S+1)-S),H=Math.log(Math.sqrt(M*M+1)-M);y=(H-B)/e,m=function(K){var Y=K*y,J=zr(B),W=u/(n*L)*(J*gu(e*Y+B)-pu(B));return[s+W*p,f+W*x,u*J/zr(e*Y+B)]}}return m.duration=y*1e3*e/Math.SQRT2,m}return i.rho=function(o){var a=Math.max(.001,+o),s=a*a,f=s*s;return t(a,s,f)},i}(Math.SQRT2,2,4);var ue=0,ye=0,ge=0,yi=1e3,on,me,an=0,te=0,pn=0,Se=typeof performance=="object"&&performance.now?performance:Date,mi=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function qn(){return te||(mi(yu),te=Se.now()+pn)}function yu(){te=0}function sn(){this._call=this._time=this._next=null}sn.prototype=Wn.prototype={constructor:sn,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?qn():+n)+(e==null?0:+e),!this._next&&me!==this&&(me?me._next=this:on=this,me=this),this._call=t,this._time=n,Dn()},stop:function(){this._call&&(this._call=null,this._time=1/0,Dn())}};function Wn(t,e,n){var r=new sn;return r.restart(t,e,n),r}function mu(){qn(),++ue;for(var t=on,e;t;)(e=te-t._time)>=0&&t._call.call(void 0,e),t=t._next;--ue}function Dr(){te=(an=Se.now())+pn,ue=ye=0;try{mu()}finally{ue=0,xu(),te=0}}function _u(){var t=Se.now(),e=t-an;e>yi&&(pn-=e,an=t)}function xu(){for(var t,e=on,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:on=n);me=t,Dn(r)}function Dn(t){if(!ue){ye&&(ye=clearTimeout(ye));var e=t-te;e>24?(t<1/0&&(ye=setTimeout(Dr,t-Se.now()-pn)),ge&&(ge=clearInterval(ge))):(ge||(an=Se.now(),ge=setInterval(_u,yi)),ue=1,mi(Dr))}}function Pr(t,e,n){var r=new sn;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var wu=hn("start","end","cancel","interrupt"),bu=[],_i=0,Or=1,Pn=2,Ye=3,Rr=4,On=5,Xe=6;function gn(t,e,n,r,i,o){var a=t.__transition;if(!a)t.__transition={};else if(n in a)return;Cu(t,n,{name:e,index:r,group:i,on:wu,tween:bu,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:_i})}function Yn(t,e){var n=Mt(t,e);if(n.state>_i)throw new Error("too late; already scheduled");return n}function kt(t,e){var n=Mt(t,e);if(n.state>Ye)throw new Error("too late; already running");return n}function Mt(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Cu(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=Wn(o,0,n.time);function o(u){n.state=Or,n.timer.restart(a,n.delay,n.time),n.delay<=u&&a(u-n.delay)}function a(u){var l,h,d,p;if(n.state!==Or)return f();for(l in r)if(p=r[l],p.name===n.name){if(p.state===Ye)return Pr(a);p.state===Rr?(p.state=Xe,p.timer.stop(),p.on.call("interrupt",t,t.__data__,p.index,p.group),delete r[l]):+l<e&&(p.state=Xe,p.timer.stop(),p.on.call("cancel",t,t.__data__,p.index,p.group),delete r[l])}if(Pr(function(){n.state===Ye&&(n.state=Rr,n.timer.restart(s,n.delay,n.time),s(u))}),n.state=Pn,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Pn){for(n.state=Ye,i=new Array(d=n.tween.length),l=0,h=-1;l<d;++l)(p=n.tween[l].value.call(t,t.__data__,n.index,n.group))&&(i[++h]=p);i.length=h+1}}function s(u){for(var l=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(f),n.state=On,1),h=-1,d=i.length;++h<d;)i[h].call(t,l);n.state===On&&(n.on.call("end",t,t.__data__,n.index,n.group),f())}function f(){n.state=Xe,n.timer.stop(),delete r[e];for(var u in r)return;delete t.__transition}}function Ke(t,e){var n=t.__transition,r,i,o=!0,a;if(n){e=e==null?null:e+"";for(a in n){if((r=n[a]).name!==e){o=!1;continue}i=r.state>Pn&&r.state<On,r.state=Xe,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[a]}o&&delete t.__transition}}function Lu(t){return this.each(function(){Ke(this,t)})}function Mu(t,e){var n,r;return function(){var i=kt(this,t),o=i.tween;if(o!==n){r=n=o;for(var a=0,s=r.length;a<s;++a)if(r[a].name===e){r=r.slice(),r.splice(a,1);break}}i.tween=r}}function Su(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var o=kt(this,t),a=o.tween;if(a!==r){i=(r=a).slice();for(var s={name:e,value:n},f=0,u=i.length;f<u;++f)if(i[f].name===e){i[f]=s;break}f===u&&i.push(s)}o.tween=i}}function $u(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=Mt(this.node(),n).tween,i=0,o=r.length,a;i<o;++i)if((a=r[i]).name===t)return a.value;return null}return this.each((e==null?Mu:Su)(n,t,e))}function Xn(t,e,n){var r=t._id;return t.each(function(){var i=kt(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return Mt(i,r).value[e]}}function xi(t,e){var n;return(typeof e=="number"?$t:e instanceof Jt?nn:(n=Jt(e))?(e=n,nn):pi)(t,e)}function Au(t){return function(){this.removeAttribute(t)}}function Nu(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ku(t,e,n){var r,i=n+"",o;return function(){var a=this.getAttribute(t);return a===i?null:a===r?o:o=e(r=a,n)}}function Tu(t,e,n){var r,i=n+"",o;return function(){var a=this.getAttributeNS(t.space,t.local);return a===i?null:a===r?o:o=e(r=a,n)}}function Eu(t,e,n){var r,i,o;return function(){var a,s=n(this),f;return s==null?void this.removeAttribute(t):(a=this.getAttribute(t),f=s+"",a===f?null:a===r&&f===i?o:(i=f,o=e(r=a,s)))}}function Iu(t,e,n){var r,i,o;return function(){var a,s=n(this),f;return s==null?void this.removeAttributeNS(t.space,t.local):(a=this.getAttributeNS(t.space,t.local),f=s+"",a===f?null:a===r&&f===i?o:(i=f,o=e(r=a,s)))}}function zu(t,e){var n=dn(t),r=n==="transform"?hu:xi;return this.attrTween(t,typeof e=="function"?(n.local?Iu:Eu)(n,r,Xn(this,"attr."+t,e)):e==null?(n.local?Nu:Au)(n):(n.local?Tu:ku)(n,r,e))}function Du(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Pu(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Ou(t,e){var n,r;function i(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&Pu(t,o)),n}return i._value=e,i}function Ru(t,e){var n,r;function i(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&Du(t,o)),n}return i._value=e,i}function Bu(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=dn(t);return this.tween(n,(r.local?Ou:Ru)(r,e))}function Fu(t,e){return function(){Yn(this,t).delay=+e.apply(this,arguments)}}function Zu(t,e){return e=+e,function(){Yn(this,t).delay=e}}function Hu(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Fu:Zu)(e,t)):Mt(this.node(),e).delay}function Gu(t,e){return function(){kt(this,t).duration=+e.apply(this,arguments)}}function Vu(t,e){return e=+e,function(){kt(this,t).duration=e}}function Uu(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Gu:Vu)(e,t)):Mt(this.node(),e).duration}function qu(t,e){if(typeof e!="function")throw new Error;return function(){kt(this,t).ease=e}}function Wu(t){var e=this._id;return arguments.length?this.each(qu(e,t)):Mt(this.node(),e).ease}function Yu(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;kt(this,t).ease=n}}function Xu(t){if(typeof t!="function")throw new Error;return this.each(Yu(this._id,t))}function Ku(t){typeof t!="function"&&(t=ei(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],a=o.length,s=r[i]=[],f,u=0;u<a;++u)(f=o[u])&&t.call(f,f.__data__,u,o)&&s.push(f);return new Pt(r,this._parents,this._name,this._id)}function ju(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var f=e[s],u=n[s],l=f.length,h=a[s]=new Array(l),d,p=0;p<l;++p)(d=f[p]||u[p])&&(h[p]=d);for(;s<r;++s)a[s]=e[s];return new Pt(a,this._parents,this._name,this._id)}function Qu(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function Ju(t,e,n){var r,i,o=Qu(e)?Yn:kt;return function(){var a=o(this,t),s=a.on;s!==r&&(i=(r=s).copy()).on(e,n),a.on=i}}function tl(t,e){var n=this._id;return arguments.length<2?Mt(this.node(),n).on.on(t):this.each(Ju(n,t,e))}function el(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function nl(){return this.on("end.remove",el(this._id))}function rl(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Hn(t));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var s=r[a],f=s.length,u=o[a]=new Array(f),l,h,d=0;d<f;++d)(l=s[d])&&(h=t.call(l,l.__data__,d,s))&&("__data__"in l&&(h.__data__=l.__data__),u[d]=h,gn(u[d],e,n,d,u,Mt(l,n)));return new Pt(o,this._parents,e,n)}function il(t){var e=this._name,n=this._id;typeof t!="function"&&(t=ti(t));for(var r=this._groups,i=r.length,o=[],a=[],s=0;s<i;++s)for(var f=r[s],u=f.length,l,h=0;h<u;++h)if(l=f[h]){for(var d=t.call(l,l.__data__,h,f),p,x=Mt(l,n),v=0,m=d.length;v<m;++v)(p=d[v])&&gn(p,e,n,v,d,x);o.push(d),a.push(l)}return new Pt(o,a,e,n)}var ol=ke.prototype.constructor;function al(){return new ol(this._groups,this._parents)}function sl(t,e){var n,r,i;return function(){var o=se(this,t),a=(this.style.removeProperty(t),se(this,t));return o===a?null:o===n&&a===r?i:i=e(n=o,r=a)}}function wi(t){return function(){this.style.removeProperty(t)}}function ul(t,e,n){var r,i=n+"",o;return function(){var a=se(this,t);return a===i?null:a===r?o:o=e(r=a,n)}}function ll(t,e,n){var r,i,o;return function(){var a=se(this,t),s=n(this),f=s+"";return s==null&&(f=s=(this.style.removeProperty(t),se(this,t))),a===f?null:a===r&&f===i?o:(i=f,o=e(r=a,s))}}function cl(t,e){var n,r,i,o="style."+e,a="end."+o,s;return function(){var f=kt(this,t),u=f.on,l=f.value[o]==null?s||(s=wi(e)):void 0;(u!==n||i!==l)&&(r=(n=u).copy()).on(a,i=l),f.on=r}}function fl(t,e,n){var r=(t+="")=="transform"?fu:xi;return e==null?this.styleTween(t,sl(t,r)).on("end.style."+t,wi(t)):typeof e=="function"?this.styleTween(t,ll(t,r,Xn(this,"style."+t,e))).each(cl(this._id,t)):this.styleTween(t,ul(t,r,e),n).on("end.style."+t,null)}function hl(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function dl(t,e,n){var r,i;function o(){var a=e.apply(this,arguments);return a!==i&&(r=(i=a)&&hl(t,a,n)),r}return o._value=e,o}function pl(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,dl(t,e,n??""))}function gl(t){return function(){this.textContent=t}}function vl(t){return function(){var e=t(this);this.textContent=e??""}}function yl(t){return this.tween("text",typeof t=="function"?vl(Xn(this,"text",t)):gl(t==null?"":t+""))}function ml(t){return function(e){this.textContent=t.call(this,e)}}function _l(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&ml(i)),e}return r._value=t,r}function xl(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,_l(t))}function wl(){for(var t=this._name,e=this._id,n=bi(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a=r[o],s=a.length,f,u=0;u<s;++u)if(f=a[u]){var l=Mt(f,e);gn(f,t,n,u,a,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new Pt(r,this._parents,t,n)}function bl(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(o,a){var s={value:a},f={value:function(){--i===0&&o()}};n.each(function(){var u=kt(this,r),l=u.on;l!==t&&(e=(t=l).copy(),e._.cancel.push(s),e._.interrupt.push(s),e._.end.push(f)),u.on=e}),i===0&&o()})}var Cl=0;function Pt(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function bi(){return++Cl}var It=ke.prototype;Pt.prototype={constructor:Pt,select:rl,selectAll:il,selectChild:It.selectChild,selectChildren:It.selectChildren,filter:Ku,merge:ju,selection:al,transition:wl,call:It.call,nodes:It.nodes,node:It.node,size:It.size,empty:It.empty,each:It.each,on:tl,attr:zu,attrTween:Bu,style:fl,styleTween:pl,text:yl,textTween:xl,remove:nl,tween:$u,delay:Hu,duration:Uu,ease:Wu,easeVarying:Xu,end:bl,[Symbol.iterator]:It[Symbol.iterator]};function Ll(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var Ml={time:null,delay:0,duration:250,ease:Ll};function Sl(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function $l(t){var e,n;t instanceof Pt?(e=t._id,t=t._name):(e=bi(),(n=Ml).time=qn(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a=r[o],s=a.length,f,u=0;u<s;++u)(f=a[u])&&gn(f,t,e,u,a,n||Sl(f,e));return new Pt(r,this._parents,t,e)}ke.prototype.interrupt=Lu;ke.prototype.transition=$l;const Ve=t=>()=>t;function Al(t,{sourceEvent:e,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function Dt(t,e,n){this.k=t,this.x=e,this.y=n}Dt.prototype={constructor:Dt,scale:function(t){return t===1?this:new Dt(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Dt(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var un=new Dt(1,0,0);Dt.prototype;function An(t){t.stopImmediatePropagation()}function ve(t){t.preventDefault(),t.stopImmediatePropagation()}function Nl(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function kl(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function Br(){return this.__zoom||un}function Tl(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function El(){return navigator.maxTouchPoints||"ontouchstart"in this}function Il(t,e,n){var r=t.invertX(e[0][0])-n[0][0],i=t.invertX(e[1][0])-n[1][0],o=t.invertY(e[0][1])-n[0][1],a=t.invertY(e[1][1])-n[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),a>o?(o+a)/2:Math.min(0,o)||Math.max(0,a))}function zl(){var t=Nl,e=kl,n=Il,r=Tl,i=El,o=[0,1/0],a=[[-1/0,-1/0],[1/0,1/0]],s=250,f=vu,u=hn("start","zoom","end"),l,h,d,p=500,x=150,v=0,m=10;function y(_){_.property("__zoom",Br).on("wheel.zoom",Y,{passive:!1}).on("mousedown.zoom",J).on("dblclick.zoom",W).filter(i).on("touchstart.zoom",E).on("touchmove.zoom",F).on("touchend.zoom touchcancel.zoom",V).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}y.transform=function(_,N,C,k){var z=_.selection?_.selection():_;z.property("__zoom",Br),_!==z?B(_,N,C,k):z.interrupt().each(function(){H(this,arguments).event(k).start().zoom(null,typeof N=="function"?N.apply(this,arguments):N).end()})},y.scaleBy=function(_,N,C,k){y.scaleTo(_,function(){var z=this.__zoom.k,P=typeof N=="function"?N.apply(this,arguments):N;return z*P},C,k)},y.scaleTo=function(_,N,C,k){y.transform(_,function(){var z=e.apply(this,arguments),P=this.__zoom,w=C==null?M(z):typeof C=="function"?C.apply(this,arguments):C,$=P.invert(w),I=typeof N=="function"?N.apply(this,arguments):N;return n(S(L(P,I),w,$),z,a)},C,k)},y.translateBy=function(_,N,C,k){y.transform(_,function(){return n(this.__zoom.translate(typeof N=="function"?N.apply(this,arguments):N,typeof C=="function"?C.apply(this,arguments):C),e.apply(this,arguments),a)},null,k)},y.translateTo=function(_,N,C,k,z){y.transform(_,function(){var P=e.apply(this,arguments),w=this.__zoom,$=k==null?M(P):typeof k=="function"?k.apply(this,arguments):k;return n(un.translate($[0],$[1]).scale(w.k).translate(typeof N=="function"?-N.apply(this,arguments):-N,typeof C=="function"?-C.apply(this,arguments):-C),P,a)},k,z)};function L(_,N){return N=Math.max(o[0],Math.min(o[1],N)),N===_.k?_:new Dt(N,_.x,_.y)}function S(_,N,C){var k=N[0]-C[0]*_.k,z=N[1]-C[1]*_.k;return k===_.x&&z===_.y?_:new Dt(_.k,k,z)}function M(_){return[(+_[0][0]+ +_[1][0])/2,(+_[0][1]+ +_[1][1])/2]}function B(_,N,C,k){_.on("start.zoom",function(){H(this,arguments).event(k).start()}).on("interrupt.zoom end.zoom",function(){H(this,arguments).event(k).end()}).tween("zoom",function(){var z=this,P=arguments,w=H(z,P).event(k),$=e.apply(z,P),I=C==null?M($):typeof C=="function"?C.apply(z,P):C,X=Math.max($[1][0]-$[0][0],$[1][1]-$[0][1]),q=z.__zoom,Z=typeof N=="function"?N.apply(z,P):N,at=f(q.invert(I).concat(X/q.k),Z.invert(I).concat(X/Z.k));return function(ut){if(ut===1)ut=Z;else{var tt=at(ut),ne=X/tt[2];ut=new Dt(ne,I[0]-tt[0]*ne,I[1]-tt[1]*ne)}w.zoom(null,ut)}})}function H(_,N,C){return!C&&_.__zooming||new K(_,N)}function K(_,N){this.that=_,this.args=N,this.active=0,this.sourceEvent=null,this.extent=e.apply(_,N),this.taps=0}K.prototype={event:function(_){return _&&(this.sourceEvent=_),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(_,N){return this.mouse&&_!=="mouse"&&(this.mouse[1]=N.invert(this.mouse[0])),this.touch0&&_!=="touch"&&(this.touch0[1]=N.invert(this.touch0[0])),this.touch1&&_!=="touch"&&(this.touch1[1]=N.invert(this.touch1[0])),this.that.__zoom=N,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(_){var N=Ft(this.that).datum();u.call(_,this.that,new Al(_,{sourceEvent:this.sourceEvent,target:y,type:_,transform:this.that.__zoom,dispatch:u}),N)}};function Y(_,...N){if(!t.apply(this,arguments))return;var C=H(this,N).event(_),k=this.__zoom,z=Math.max(o[0],Math.min(o[1],k.k*Math.pow(2,r.apply(this,arguments)))),P=Xt(_);if(C.wheel)(C.mouse[0][0]!==P[0]||C.mouse[0][1]!==P[1])&&(C.mouse[1]=k.invert(C.mouse[0]=P)),clearTimeout(C.wheel);else{if(k.k===z)return;C.mouse=[P,k.invert(P)],Ke(this),C.start()}ve(_),C.wheel=setTimeout(w,x),C.zoom("mouse",n(S(L(k,z),C.mouse[0],C.mouse[1]),C.extent,a));function w(){C.wheel=null,C.end()}}function J(_,...N){if(d||!t.apply(this,arguments))return;var C=_.currentTarget,k=H(this,N,!0).event(_),z=Ft(_.view).on("mousemove.zoom",I,!0).on("mouseup.zoom",X,!0),P=Xt(_,C),w=_.clientX,$=_.clientY;Bs(_.view),An(_),k.mouse=[P,this.__zoom.invert(P)],Ke(this),k.start();function I(q){if(ve(q),!k.moved){var Z=q.clientX-w,at=q.clientY-$;k.moved=Z*Z+at*at>v}k.event(q).zoom("mouse",n(S(k.that.__zoom,k.mouse[0]=Xt(q,C),k.mouse[1]),k.extent,a))}function X(q){z.on("mousemove.zoom mouseup.zoom",null),Fs(q.view,k.moved),ve(q),k.event(q).end()}}function W(_,...N){if(t.apply(this,arguments)){var C=this.__zoom,k=Xt(_.changedTouches?_.changedTouches[0]:_,this),z=C.invert(k),P=C.k*(_.shiftKey?.5:2),w=n(S(L(C,P),k,z),e.apply(this,N),a);ve(_),s>0?Ft(this).transition().duration(s).call(B,w,k,_):Ft(this).call(y.transform,w,k,_)}}function E(_,...N){if(t.apply(this,arguments)){var C=_.touches,k=C.length,z=H(this,N,_.changedTouches.length===k).event(_),P,w,$,I;for(An(_),w=0;w<k;++w)$=C[w],I=Xt($,this),I=[I,this.__zoom.invert(I),$.identifier],z.touch0?!z.touch1&&z.touch0[2]!==I[2]&&(z.touch1=I,z.taps=0):(z.touch0=I,P=!0,z.taps=1+!!l);l&&(l=clearTimeout(l)),P&&(z.taps<2&&(h=I[0],l=setTimeout(function(){l=null},p)),Ke(this),z.start())}}function F(_,...N){if(this.__zooming){var C=H(this,N).event(_),k=_.changedTouches,z=k.length,P,w,$,I;for(ve(_),P=0;P<z;++P)w=k[P],$=Xt(w,this),C.touch0&&C.touch0[2]===w.identifier?C.touch0[0]=$:C.touch1&&C.touch1[2]===w.identifier&&(C.touch1[0]=$);if(w=C.that.__zoom,C.touch1){var X=C.touch0[0],q=C.touch0[1],Z=C.touch1[0],at=C.touch1[1],ut=(ut=Z[0]-X[0])*ut+(ut=Z[1]-X[1])*ut,tt=(tt=at[0]-q[0])*tt+(tt=at[1]-q[1])*tt;w=L(w,Math.sqrt(ut/tt)),$=[(X[0]+Z[0])/2,(X[1]+Z[1])/2],I=[(q[0]+at[0])/2,(q[1]+at[1])/2]}else if(C.touch0)$=C.touch0[0],I=C.touch0[1];else return;C.zoom("touch",n(S(w,$,I),C.extent,a))}}function V(_,...N){if(this.__zooming){var C=H(this,N).event(_),k=_.changedTouches,z=k.length,P,w;for(An(_),d&&clearTimeout(d),d=setTimeout(function(){d=null},p),P=0;P<z;++P)w=k[P],C.touch0&&C.touch0[2]===w.identifier?delete C.touch0:C.touch1&&C.touch1[2]===w.identifier&&delete C.touch1;if(C.touch1&&!C.touch0&&(C.touch0=C.touch1,delete C.touch1),C.touch0)C.touch0[1]=this.__zoom.invert(C.touch0[0]);else if(C.end(),C.taps===2&&(w=Xt(w,this),Math.hypot(h[0]-w[0],h[1]-w[1])<m)){var $=Ft(this).on("dblclick.zoom");$&&$.apply(this,arguments)}}}return y.wheelDelta=function(_){return arguments.length?(r=typeof _=="function"?_:Ve(+_),y):r},y.filter=function(_){return arguments.length?(t=typeof _=="function"?_:Ve(!!_),y):t},y.touchable=function(_){return arguments.length?(i=typeof _=="function"?_:Ve(!!_),y):i},y.extent=function(_){return arguments.length?(e=typeof _=="function"?_:Ve([[+_[0][0],+_[0][1]],[+_[1][0],+_[1][1]]]),y):e},y.scaleExtent=function(_){return arguments.length?(o[0]=+_[0],o[1]=+_[1],y):[o[0],o[1]]},y.translateExtent=function(_){return arguments.length?(a[0][0]=+_[0][0],a[1][0]=+_[1][0],a[0][1]=+_[0][1],a[1][1]=+_[1][1],y):[[a[0][0],a[0][1]],[a[1][0],a[1][1]]]},y.constrain=function(_){return arguments.length?(n=_,y):n},y.duration=function(_){return arguments.length?(s=+_,y):s},y.interpolate=function(_){return arguments.length?(f=_,y):f},y.on=function(){var _=u.on.apply(u,arguments);return _===u?y:_},y.clickDistance=function(_){return arguments.length?(v=(_=+_)*_,y):Math.sqrt(v)},y.tapDistance=function(_){return arguments.length?(m=+_,y):m},y}const ce=Bn("layout",()=>{const t=j({}),e=j({x:0,y:0}),n=j({x:0,y:0,k:1});return{nodes:t,offset:e,transform:n}});function Dl(t,e){var n,r=1;t==null&&(t=0),e==null&&(e=0);function i(){var o,a=n.length,s,f=0,u=0;for(o=0;o<a;++o)s=n[o],f+=s.x,u+=s.y;for(f=(f/a-t)*r,u=(u/a-e)*r,o=0;o<a;++o)s=n[o],s.x-=f,s.y-=u}return i.initialize=function(o){n=o},i.x=function(o){return arguments.length?(t=+o,i):t},i.y=function(o){return arguments.length?(e=+o,i):e},i.strength=function(o){return arguments.length?(r=+o,i):r},i}function Pl(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return Ci(this.cover(e,n),e,n,t)}function Ci(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,o=t._root,a={data:r},s=t._x0,f=t._y0,u=t._x1,l=t._y1,h,d,p,x,v,m,y,L;if(!o)return t._root=a,t;for(;o.length;)if((v=e>=(h=(s+u)/2))?s=h:u=h,(m=n>=(d=(f+l)/2))?f=d:l=d,i=o,!(o=o[y=m<<1|v]))return i[y]=a,t;if(p=+t._x.call(null,o.data),x=+t._y.call(null,o.data),e===p&&n===x)return a.next=o,i?i[y]=a:t._root=a,t;do i=i?i[y]=new Array(4):t._root=new Array(4),(v=e>=(h=(s+u)/2))?s=h:u=h,(m=n>=(d=(f+l)/2))?f=d:l=d;while((y=m<<1|v)===(L=(x>=d)<<1|p>=h));return i[L]=o,i[y]=a,t}function Ol(t){var e,n,r=t.length,i,o,a=new Array(r),s=new Array(r),f=1/0,u=1/0,l=-1/0,h=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,e=t[n]))||isNaN(o=+this._y.call(null,e))||(a[n]=i,s[n]=o,i<f&&(f=i),i>l&&(l=i),o<u&&(u=o),o>h&&(h=o));if(f>l||u>h)return this;for(this.cover(f,u).cover(l,h),n=0;n<r;++n)Ci(this,a[n],s[n],t[n]);return this}function Rl(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,o=(r=Math.floor(e))+1;else{for(var a=i-n||1,s=this._root,f,u;n>t||t>=i||r>e||e>=o;)switch(u=(e<r)<<1|t<n,f=new Array(4),f[u]=s,s=f,a*=2,u){case 0:i=n+a,o=r+a;break;case 1:n=i-a,o=r+a;break;case 2:i=n+a,r=o-a;break;case 3:n=i-a,r=o-a;break}this._root&&this._root.length&&(this._root=s)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this}function Bl(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t}function Fl(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function ft(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i}function Zl(t,e,n){var r,i=this._x0,o=this._y0,a,s,f,u,l=this._x1,h=this._y1,d=[],p=this._root,x,v;for(p&&d.push(new ft(p,i,o,l,h)),n==null?n=1/0:(i=t-n,o=e-n,l=t+n,h=e+n,n*=n);x=d.pop();)if(!(!(p=x.node)||(a=x.x0)>l||(s=x.y0)>h||(f=x.x1)<i||(u=x.y1)<o))if(p.length){var m=(a+f)/2,y=(s+u)/2;d.push(new ft(p[3],m,y,f,u),new ft(p[2],a,y,m,u),new ft(p[1],m,s,f,y),new ft(p[0],a,s,m,y)),(v=(e>=y)<<1|t>=m)&&(x=d[d.length-1],d[d.length-1]=d[d.length-1-v],d[d.length-1-v]=x)}else{var L=t-+this._x.call(null,p.data),S=e-+this._y.call(null,p.data),M=L*L+S*S;if(M<n){var B=Math.sqrt(n=M);i=t-B,o=e-B,l=t+B,h=e+B,r=p.data}}return r}function Hl(t){if(isNaN(l=+this._x.call(null,t))||isNaN(h=+this._y.call(null,t)))return this;var e,n=this._root,r,i,o,a=this._x0,s=this._y0,f=this._x1,u=this._y1,l,h,d,p,x,v,m,y;if(!n)return this;if(n.length)for(;;){if((x=l>=(d=(a+f)/2))?a=d:f=d,(v=h>=(p=(s+u)/2))?s=p:u=p,e=n,!(n=n[m=v<<1|x]))return this;if(!n.length)break;(e[m+1&3]||e[m+2&3]||e[m+3&3])&&(r=e,y=m)}for(;n.data!==t;)if(i=n,!(n=n.next))return this;return(o=n.next)&&delete n.next,i?(o?i.next=o:delete i.next,this):e?(o?e[m]=o:delete e[m],(n=e[0]||e[1]||e[2]||e[3])&&n===(e[3]||e[2]||e[1]||e[0])&&!n.length&&(r?r[y]=n:this._root=n),this):(this._root=o,this)}function Gl(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function Vl(){return this._root}function Ul(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}function ql(t){var e=[],n,r=this._root,i,o,a,s,f;for(r&&e.push(new ft(r,this._x0,this._y0,this._x1,this._y1));n=e.pop();)if(!t(r=n.node,o=n.x0,a=n.y0,s=n.x1,f=n.y1)&&r.length){var u=(o+s)/2,l=(a+f)/2;(i=r[3])&&e.push(new ft(i,u,l,s,f)),(i=r[2])&&e.push(new ft(i,o,l,u,f)),(i=r[1])&&e.push(new ft(i,u,a,s,l)),(i=r[0])&&e.push(new ft(i,o,a,u,l))}return this}function Wl(t){var e=[],n=[],r;for(this._root&&e.push(new ft(this._root,this._x0,this._y0,this._x1,this._y1));r=e.pop();){var i=r.node;if(i.length){var o,a=r.x0,s=r.y0,f=r.x1,u=r.y1,l=(a+f)/2,h=(s+u)/2;(o=i[0])&&e.push(new ft(o,a,s,l,h)),(o=i[1])&&e.push(new ft(o,l,s,f,h)),(o=i[2])&&e.push(new ft(o,a,h,l,u)),(o=i[3])&&e.push(new ft(o,l,h,f,u))}n.push(r)}for(;r=n.pop();)t(r.node,r.x0,r.y0,r.x1,r.y1);return this}function Yl(t){return t[0]}function Xl(t){return arguments.length?(this._x=t,this):this._x}function Kl(t){return t[1]}function jl(t){return arguments.length?(this._y=t,this):this._y}function Kn(t,e,n){var r=new jn(e??Yl,n??Kl,NaN,NaN,NaN,NaN);return t==null?r:r.addAll(t)}function jn(t,e,n,r,i,o){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function Fr(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var dt=Kn.prototype=jn.prototype;dt.copy=function(){var t=new jn(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,n,r;if(!e)return t;if(!e.length)return t._root=Fr(e),t;for(n=[{source:e,target:t._root=new Array(4)}];e=n.pop();)for(var i=0;i<4;++i)(r=e.source[i])&&(r.length?n.push({source:r,target:e.target[i]=new Array(4)}):e.target[i]=Fr(r));return t};dt.add=Pl;dt.addAll=Ol;dt.cover=Rl;dt.data=Bl;dt.extent=Fl;dt.find=Zl;dt.remove=Hl;dt.removeAll=Gl;dt.root=Vl;dt.size=Ul;dt.visit=ql;dt.visitAfter=Wl;dt.x=Xl;dt.y=jl;function Ct(t){return function(){return t}}function Zt(t){return(t()-.5)*1e-6}function Ql(t){return t.x+t.vx}function Jl(t){return t.y+t.vy}function tc(t){var e,n,r,i=1,o=1;typeof t!="function"&&(t=Ct(t==null?1:+t));function a(){for(var u,l=e.length,h,d,p,x,v,m,y=0;y<o;++y)for(h=Kn(e,Ql,Jl).visitAfter(s),u=0;u<l;++u)d=e[u],v=n[d.index],m=v*v,p=d.x+d.vx,x=d.y+d.vy,h.visit(L);function L(S,M,B,H,K){var Y=S.data,J=S.r,W=v+J;if(Y){if(Y.index>d.index){var E=p-Y.x-Y.vx,F=x-Y.y-Y.vy,V=E*E+F*F;V<W*W&&(E===0&&(E=Zt(r),V+=E*E),F===0&&(F=Zt(r),V+=F*F),V=(W-(V=Math.sqrt(V)))/V*i,d.vx+=(E*=V)*(W=(J*=J)/(m+J)),d.vy+=(F*=V)*W,Y.vx-=E*(W=1-W),Y.vy-=F*W)}return}return M>p+W||H<p-W||B>x+W||K<x-W}}function s(u){if(u.data)return u.r=n[u.data.index];for(var l=u.r=0;l<4;++l)u[l]&&u[l].r>u.r&&(u.r=u[l].r)}function f(){if(e){var u,l=e.length,h;for(n=new Array(l),u=0;u<l;++u)h=e[u],n[h.index]=+t(h,u,e)}}return a.initialize=function(u,l){e=u,r=l,f()},a.iterations=function(u){return arguments.length?(o=+u,a):o},a.strength=function(u){return arguments.length?(i=+u,a):i},a.radius=function(u){return arguments.length?(t=typeof u=="function"?u:Ct(+u),f(),a):t},a}function ec(t){return t.index}function Zr(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function nc(t){var e=ec,n=h,r,i=Ct(30),o,a,s,f,u,l=1;t==null&&(t=[]);function h(m){return 1/Math.min(s[m.source.index],s[m.target.index])}function d(m){for(var y=0,L=t.length;y<l;++y)for(var S=0,M,B,H,K,Y,J,W;S<L;++S)M=t[S],B=M.source,H=M.target,K=H.x+H.vx-B.x-B.vx||Zt(u),Y=H.y+H.vy-B.y-B.vy||Zt(u),J=Math.sqrt(K*K+Y*Y),J=(J-o[S])/J*m*r[S],K*=J,Y*=J,H.vx-=K*(W=f[S]),H.vy-=Y*W,B.vx+=K*(W=1-W),B.vy+=Y*W}function p(){if(a){var m,y=a.length,L=t.length,S=new Map(a.map((B,H)=>[e(B,H,a),B])),M;for(m=0,s=new Array(y);m<L;++m)M=t[m],M.index=m,typeof M.source!="object"&&(M.source=Zr(S,M.source)),typeof M.target!="object"&&(M.target=Zr(S,M.target)),s[M.source.index]=(s[M.source.index]||0)+1,s[M.target.index]=(s[M.target.index]||0)+1;for(m=0,f=new Array(L);m<L;++m)M=t[m],f[m]=s[M.source.index]/(s[M.source.index]+s[M.target.index]);r=new Array(L),x(),o=new Array(L),v()}}function x(){if(a)for(var m=0,y=t.length;m<y;++m)r[m]=+n(t[m],m,t)}function v(){if(a)for(var m=0,y=t.length;m<y;++m)o[m]=+i(t[m],m,t)}return d.initialize=function(m,y){a=m,u=y,p()},d.links=function(m){return arguments.length?(t=m,p(),d):t},d.id=function(m){return arguments.length?(e=m,d):e},d.iterations=function(m){return arguments.length?(l=+m,d):l},d.strength=function(m){return arguments.length?(n=typeof m=="function"?m:Ct(+m),x(),d):n},d.distance=function(m){return arguments.length?(i=typeof m=="function"?m:Ct(+m),v(),d):i},d}const rc=1664525,ic=1013904223,Hr=4294967296;function oc(){let t=1;return()=>(t=(rc*t+ic)%Hr)/Hr}function ac(t){return t.x}function sc(t){return t.y}var uc=10,lc=Math.PI*(3-Math.sqrt(5));function cc(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,a=.6,s=new Map,f=Wn(h),u=hn("tick","end"),l=oc();t==null&&(t=[]);function h(){d(),u.call("tick",e),n<r&&(f.stop(),u.call("end",e))}function d(v){var m,y=t.length,L;v===void 0&&(v=1);for(var S=0;S<v;++S)for(n+=(o-n)*i,s.forEach(function(M){M(n)}),m=0;m<y;++m)L=t[m],L.fx==null?L.x+=L.vx*=a:(L.x=L.fx,L.vx=0),L.fy==null?L.y+=L.vy*=a:(L.y=L.fy,L.vy=0);return e}function p(){for(var v=0,m=t.length,y;v<m;++v){if(y=t[v],y.index=v,y.fx!=null&&(y.x=y.fx),y.fy!=null&&(y.y=y.fy),isNaN(y.x)||isNaN(y.y)){var L=uc*Math.sqrt(.5+v),S=v*lc;y.x=L*Math.cos(S),y.y=L*Math.sin(S)}(isNaN(y.vx)||isNaN(y.vy))&&(y.vx=y.vy=0)}}function x(v){return v.initialize&&v.initialize(t,l),v}return p(),e={tick:d,restart:function(){return f.restart(h),e},stop:function(){return f.stop(),e},nodes:function(v){return arguments.length?(t=v,p(),s.forEach(x),e):t},alpha:function(v){return arguments.length?(n=+v,e):n},alphaMin:function(v){return arguments.length?(r=+v,e):r},alphaDecay:function(v){return arguments.length?(i=+v,e):+i},alphaTarget:function(v){return arguments.length?(o=+v,e):o},velocityDecay:function(v){return arguments.length?(a=1-v,e):1-a},randomSource:function(v){return arguments.length?(l=v,s.forEach(x),e):l},force:function(v,m){return arguments.length>1?(m==null?s.delete(v):s.set(v,x(m)),e):s.get(v)},find:function(v,m,y){var L=0,S=t.length,M,B,H,K,Y;for(y==null?y=1/0:y*=y,L=0;L<S;++L)K=t[L],M=v-K.x,B=m-K.y,H=M*M+B*B,H<y&&(Y=K,y=H);return Y},on:function(v,m){return arguments.length>1?(u.on(v,m),e):u.on(v)}}}function fc(){var t,e,n,r,i=Ct(-30),o,a=1,s=1/0,f=.81;function u(p){var x,v=t.length,m=Kn(t,ac,sc).visitAfter(h);for(r=p,x=0;x<v;++x)e=t[x],m.visit(d)}function l(){if(t){var p,x=t.length,v;for(o=new Array(x),p=0;p<x;++p)v=t[p],o[v.index]=+i(v,p,t)}}function h(p){var x=0,v,m,y=0,L,S,M;if(p.length){for(L=S=M=0;M<4;++M)(v=p[M])&&(m=Math.abs(v.value))&&(x+=v.value,y+=m,L+=m*v.x,S+=m*v.y);p.x=L/y,p.y=S/y}else{v=p,v.x=v.data.x,v.y=v.data.y;do x+=o[v.data.index];while(v=v.next)}p.value=x}function d(p,x,v,m){if(!p.value)return!0;var y=p.x-e.x,L=p.y-e.y,S=m-x,M=y*y+L*L;if(S*S/f<M)return M<s&&(y===0&&(y=Zt(n),M+=y*y),L===0&&(L=Zt(n),M+=L*L),M<a&&(M=Math.sqrt(a*M)),e.vx+=y*p.value*r/M,e.vy+=L*p.value*r/M),!0;if(p.length||M>=s)return;(p.data!==e||p.next)&&(y===0&&(y=Zt(n),M+=y*y),L===0&&(L=Zt(n),M+=L*L),M<a&&(M=Math.sqrt(a*M)));do p.data!==e&&(S=o[p.data.index]*r/M,e.vx+=y*S,e.vy+=L*S);while(p=p.next)}return u.initialize=function(p,x){t=p,n=x,l()},u.strength=function(p){return arguments.length?(i=typeof p=="function"?p:Ct(+p),l(),u):i},u.distanceMin=function(p){return arguments.length?(a=p*p,u):Math.sqrt(a)},u.distanceMax=function(p){return arguments.length?(s=p*p,u):Math.sqrt(s)},u.theta=function(p){return arguments.length?(f=p*p,u):Math.sqrt(f)},u}function hc(t,e,n){var r,i=Ct(.1),o,a;typeof t!="function"&&(t=Ct(+t)),e==null&&(e=0),n==null&&(n=0);function s(u){for(var l=0,h=r.length;l<h;++l){var d=r[l],p=d.x-e||1e-6,x=d.y-n||1e-6,v=Math.sqrt(p*p+x*x),m=(a[l]-v)*o[l]*u/v;d.vx+=p*m,d.vy+=x*m}}function f(){if(r){var u,l=r.length;for(o=new Array(l),a=new Array(l),u=0;u<l;++u)a[u]=+t(r[u],u,r),o[u]=isNaN(a[u])?0:+i(r[u],u,r)}}return s.initialize=function(u){r=u,f()},s.strength=function(u){return arguments.length?(i=typeof u=="function"?u:Ct(+u),f(),s):i},s.radius=function(u){return arguments.length?(t=typeof u=="function"?u:Ct(+u),f(),s):t},s.x=function(u){return arguments.length?(e=+u,s):e},s.y=function(u){return arguments.length?(n=+u,s):n},s}const je=Lt(),ie=ce();function dc(t){var u,l;ie.offset.x+=((u=ie.nodes[t])==null?void 0:u.x)??0,ie.offset.y+=((l=ie.nodes[t])==null?void 0:l.y)??0;const n=Li(t,1).flat(2),r=[...new Set(n.map(h=>h.id))].filter(h=>{var d;return["entity","predicate"].includes((d=je.data.nodes[h])==null?void 0:d.type)}),o=[...r.map(h=>{const d=n.filter(p=>p.id===h).map(({depth:p})=>p);return{id:h,depth:1-Math.max(...d)}}).map(({id:h,depth:d})=>({id:h,depth:d,...f(h)}))],a=[...je.data.edges.filter(h=>r.includes(h.nodes[0])&&r.includes(h.nodes[1])).map(h=>({source:h.nodes[0],target:h.nodes[1]}))],s=cc(o).force("link",nc(a).id(h=>h.id).distance(100)).force("collide",tc().radius(h=>{var d;return((d=je.data.nodes[h.id])==null?void 0:d.type)==="graph"?160:50})).force("charge",fc().strength(-5e3)).force("center",Dl(0,0)).force("radial",hc(h=>h.depth*550,0,0).strength(2));for(let h=0;h<1e3;h++)s.tick();return Object.fromEntries(o.filter(({proxy:h})=>!h).map(({id:h,x:d,y:p})=>[h,{x:d,y:p}]));function f(h){if(h===t)return{x:0,y:0};if(ie.nodes[h]!=null)return ie.nodes[h];const d=Math.random()*Math.PI*2;return{x:Math.cos(d)*250,y:Math.sin(d)*250}}}function Li(t,e=1){return[{id:t,depth:e},...je.data.edges.filter(n=>n.nodes.includes(t)).map(n=>{const r=n.nodes.find(i=>i!==t);return e===1?{id:r,depth:0}:Li(r,e-1)})]}const Qn=Bn("display",()=>{const t=Gt(),e=Lt(),n=D(()=>{var u,l;return((u=e.node)==null?void 0:u.marker)==null?[]:(l=e.node)==null?void 0:l.marker.filter(h=>h.time<=t.time).sort((h,d)=>h.time-d.time)}),r=D(()=>{var u,l;return(l=(u=e.node)==null?void 0:u.marker)==null?void 0:l.find(h=>h.time===t.time)}),i=D(()=>n.value.reduce((u,l)=>({...u,...l.states}),{states:{}})),o=D(()=>{var u;return(u=n.value.findLast(l=>l.bounds!=null))==null?void 0:u.bounds});function a(u){return u.includes("hide")?"hide":u.every(l=>l==="highlight")?"highlight":"default"}function s(u){const l=u.map(h=>e.data.nodes[h].inheritDisplay?f(h):i.value[h]);return a(l)}function f(u){const l=e.data.edges.filter(h=>h.nodes.includes(u)).map(h=>{const d=h.nodes.find(p=>p!==u);return i.value[d]});return a(l)}return{markers:n,exactMarker:r,states:i,bounds:o,inheritStateFromNodes:s,inheritStateFromNeighbor:f}}),pc=["onClick"],gc={__name:"ContextMenuList",props:["context"],setup(t){return(e,n)=>(A(),ot(Yr,{class:"context-menu-list"},{default:nt(()=>[(A(!0),R(jt,null,ae(t.context,(r,i)=>(A(),R("button",{key:i,onClick:r.action},be(r.label),9,pc))),128))]),_:1}))}},vn=ht(gc,[["__scopeId","data-v-5b0e52e5"]]),vc=Bn("connect",()=>{const t=Lt(),e=j(!1),n=j({x:100,y:100}),r=j(null),i=j(null),o=j(null),a=new AbortController;function s(u,l,h){e.value=!0,i.value=l,r.value=u,o.value=h,window.addEventListener("keydown",d=>{d.key==="Escape"&&(a.abort(),e.value=!1)},{signal:a.signal})}function f(u){a.abort(),e.value=!1,t.data.edges.push({nodes:[r.value,u],arrow:i.value,graph:o.value,id:crypto.randomUUID()})}return{connecting:e,offset:n,open:s,start:r,close:f}}),xe=ce();function yc(t){var r;const e=document.createRange(),n=(r=t.value)==null?void 0:r.childNodes;return n==null?0:(e.setStartBefore(n[0]),e.setEndAfter(n[n.length-1]),`${e.getBoundingClientRect().width/xe.transform.k}px`)}function Mi(t,e,n,r=0,i=0){var d;const o=document.createRange();if(((d=t.value)==null?void 0:d.childNodes)==null)return{};let s=t.value.firstElementChild;for(let p=r;p>0;p--)s=s.nextElementSibling;let f=t.value.lastElementChild;for(let p=i;p>0;p--)f=f.previousElementSibling;o.setStartBefore(s),o.setEndAfter(f);const u=o.getBoundingClientRect(),l=t.value.getBoundingClientRect().width,h={...n,width:Math.min(u.width,l)/xe.transform.k,height:u.height/xe.transform.k};return xe.nodes[e]=h,h}function Gr(t){if(t!=null)return t.getBoundingClientRect().width/xe.transform.k}const mc={class:"horizontal-slider"},_c=["disabled"],xc=["disabled"],wc={__name:"HorizontalSlider",props:{itemWidth:{type:Number,default:250},noArrows:Boolean},setup(t){const e=t,n=j(null),r=j(0),i=j(0),o=j(0),a=j(null),s=j(null),f=new ResizeObserver(p=>{for(const x of p)x.contentRect&&(a.value=`${(window.innerWidth-800)/2-30}px`,s.value=`${Math.max((window.innerWidth-800)/2-10,30)}px`,Ce(()=>{r.value=n.value.scrollWidth,i.value=n.value.offsetWidth}))}),u=D(()=>o.value>35&&!e.noArrows),l=D(()=>o.value<r.value-i.value-35&&!e.noArrows);function h(){o.value=n.value.scrollLeft??0}const d=p=>{const m=Math.max(Math.floor(250/e.itemWidth),1);n.value.scrollBy({left:m*(e.itemWidth+10)*p,behavior:"smooth"})};return le(()=>{f.observe(n.value)}),Fn(()=>{f.unobserve(n.value)}),(p,x)=>(A(),R("div",mc,[G("button",{disabled:!u.value,tabindex:"-1",class:"arrow left",onClick:x[0]||(x[0]=v=>d(-1))}," ← ",8,_c),G("button",{disabled:!l.value,tabindex:"-1",class:"arrow right",onClick:x[1]||(x[1]=v=>d(1))}," → ",8,xc),G("div",{ref_key:"wrapper",ref:n,class:"wrapper",onScroll:h,style:{scrollPaddingInlineStart:"0px"}},[Xr(p.$slots,"default",{},void 0,!0)],544)]))}},bc=ht(wc,[["__scopeId","data-v-0b4d1e9f"]]),Cc={class:"icon",width:"45",height:"45",viewBox:"0 0 45 45",xmlns:"http://www.w3.org/2000/svg"};function Lc(t,e){return A(),R("svg",Cc,e[0]||(e[0]=[G("path",{d:"M17,15.7895644 L17,29.2104356 C17,29.7627203 17.4477153,30.2104356 18,30.2104356 C18.1850598,30.2104356 18.3664897,30.1590832 18.5240974,30.0620939 L29.4285552,23.3516583 C29.8989131,23.0622073 30.0455671,22.4462605 29.7561161,21.9759026 C29.6740728,21.8425821 29.5618757,21.730385 29.4285552,21.6483417 L18.5240974,14.9379061 C18.0537395,14.6484551 17.4377927,14.7951091 17.1483417,15.265467 C17.0513523,15.4230747 17,15.6045046 17,15.7895644 Z",fill:"currentColor","fill-rule":"evenodd"},null,-1)]))}const Si={name:"base-ControlsPlay",render:Lc},Mc={class:"icon",width:"21",height:"21",viewBox:"0 0 21 21",xmlns:"http://www.w3.org/2000/svg"};function Sc(t,e){return A(),R("svg",Mc,e[0]||(e[0]=[G("path",{d:"M10.5,21 C16.2989899,21 21,16.2989899 21,10.5 C21,4.70101013 16.2989899,0 10.5,0 C4.70101013,0 0,4.70101013 0,10.5 C0,16.2989899 4.70101013,21 10.5,21 Z M10.5,14 C12.4329966,14 14,12.4329966 14,10.5 C14,8.56700338 12.4329966,7 10.5,7 C8.56700338,7 7,8.56700338 7,10.5 C7,12.4329966 8.56700338,14 10.5,14 Z",fill:"currentColor","fill-rule":"evenodd"},null,-1)]))}const $c={name:"base-IconPlaying",render:Sc},Ac={__name:"IconPlaying",setup(t){return(e,n)=>(A(),ot(O($c)))}},Nc=ht(Ac,[["__scopeId","data-v-aea62c91"]]),kc=["src"],Tc={key:1,class:"image-placeholder"},Ec={class:"icon"},Ic={__name:"GraphNodeGraph",props:{node:Object,id:String,position:Object},setup(t,{expose:e}){const n=t,r=$e(),i=Gt(),o=ee(),a=j(null),s=j(null),f=D(()=>r.localize(n.node.label)),u=D(()=>r.getMediaUrl(n.node.image)),l=D(()=>({"--graph-accent":`var(--${n.node.color})`})),h=D(()=>i.graphId===n.id&&i.playing),d=D(()=>i.next===n.id),p=D(()=>{if(!d.value)return;const v=i.duration-i.time;if(!(v>5))return{"--autoplay":`${100-v*20}%`}});le(()=>{x()}),zt(()=>o.lang,()=>Ce(()=>x()));function x(v){Mi(s,n.id,n.position,null,v),console.log()}return e({el:s}),(v,m)=>(A(),R("div",{class:"node-graph",ref_key:"el",ref:s,style:vt({...l.value,...p.value})},[u.value?(A(),R("img",{key:0,src:u.value,draggable:"false"},null,8,kc)):(A(),R("div",Tc)),G("div",Ec,[h.value?(A(),ot(Nc,{key:1})):(A(),ot(O(Si),{key:0}))]),G("div",{class:"text",ref_key:"textElement",ref:a},[G("span",null,[G("span",null,be(f.value),1)])],512)],4))}},$i=ht(Ic,[["__scopeId","data-v-30a3f98f"]]),zc={key:0},Dc={key:2,class:"description"},Pc={key:3,class:"urls"},Oc=["href"],Rc={__name:"GraphNodeEntity",props:{node:Object,id:String,occurances:Object,position:Object},setup(t,{expose:e}){const n=Ae(),r=t,i=Lt(),o=ee(),a=$e(),s=j(null),f=j(null),u=j(null),l=j(!1),h=j(null),d=j(null),p=D(()=>{var S;return(S=i.data.nodes[r.node.class])==null?void 0:S.label}),x=D(()=>n.params.id===r.id),v=D(()=>{if(x.value)return a.localize(r.node.description,!0)}),m=D(()=>{if(!(!x.value||r.node.url==null))return r.node.url.map(S=>({full:S,domain:new URL(S).hostname.replace(/^www\./,"")}))});le(()=>{y()}),zt(x,S=>{S&&(l.value=!0);const M=(Gr(s.value.querySelector(".label"))-250)/2;h.value={margin:`0 ${-M}px 0 ${M}px`};const B=(Gr(s.value.querySelector(".class"))-250)/2;d.value={margin:`0 ${-B}px 0 ${B}px`},Ce(()=>{y(S?0:1),S||(l.value=!0,h.value=null,d.value=null)})}),zt(()=>o.lang,()=>Ce(()=>y())),e({el:s});function y(S){const M=Mi(s,r.id,r.position,null,S);u.value=`${M.height}px`}function L(S){S.propertyName==="margin-left"&&(l.value=!1,h.value=null,d.value=null)}return(S,M)=>{const B=Uo("RouterLink");return A(),R("div",{class:At(["entity",{detail:x.value}]),ref_key:"el",ref:s,style:vt({width:f.value,height:u.value})},[G("span",{class:At(["label",{"animate-text-align":l.value}]),style:vt(h.value),onTransitionend:L},[Q(Qe,{text:t.node.label},null,8,["text"])],38),p.value?(A(),R("br",zc)):wt("",!0),p.value?(A(),R("span",{key:1,class:At(["class",{"animate-text-align":l.value}]),style:vt(d.value)},[Q(Qe,{text:p.value},null,8,["text"])],6)):wt("",!0),v.value?(A(),R("div",Dc,be(v.value),1)):wt("",!0),m.value&&!O(o).exhibition?(A(),R("div",Pc,[(A(!0),R(jt,null,ae(m.value,(H,K)=>(A(),R("span",{key:K},[G("a",{href:H.full},be(H.domain),9,Oc),M[2]||(M[2]=qo("  "))]))),128))])):wt("",!0),Q(Wo,{name:"stories"},{default:nt(()=>[x.value?(A(),ot(bc,{key:0,class:"occurances",onWheel:M[1]||(M[1]=Ht(()=>{},["stop"])),"no-arrows":l.value},{default:nt(()=>[(A(!0),R(jt,null,ae(t.occurances,H=>(A(),ot(B,{class:"occurance",onClick:M[0]||(M[0]=Ht(()=>{},["stop"])),key:H.id,to:{name:"graph",params:{type:"graph",id:H.id}}},{default:nt(()=>[Q($i,{id:H.id,node:H,class:"compact"},null,8,["id","node"])]),_:2},1032,["to"]))),128))]),_:1},8,["no-arrows"])):wt("",!0)]),_:1})],6)}}},Bc=ht(Rc,[["__scopeId","data-v-0be95d6f"]]),Fc={data(){return{count:0}},props:{node:Object},computed:{label(){return this.helperStore.localize(this.node.label??this.node.text)},...Yo($e)}},Zc={class:"entity",ref:"el"},Hc={class:"text measure-width"};function Gc(t,e,n,r,i,o){return A(),R("div",Zc,[G("span",Hc,be(o.label),1)],512)}const Vc=ht(Fc,[["render",Gc],["__scopeId","data-v-b64e33c2"]]),Uc={class:"image"},qc=["srcset"],Wc={__name:"GraphNodeImage",props:{node:Object},setup(t,{expose:e}){const n=t,r=$e(),i=j(null),o=D(()=>r.getMediaUrl(n.node.file));return e({el:i}),(a,s)=>(A(),R("div",Uc,[G("img",{ref_key:"el",ref:i,srcset:`${o.value} 2x`,draggable:"false"},null,8,qc)]))}},Yc=ht(Wc,[["__scopeId","data-v-7cbb6b98"]]),Xc={__name:"GraphNodeNote",props:{node:Object,occurances:Array},setup(t,{expose:e}){const n=t,r=$e(),i=j(null),o=j(null);D(()=>r.localize(n.node.text));const a=D(()=>{if(!(n.occurances.length!==1||n.occurances[0].color==null))return{"--graph-accent":`var(--${n.occurances[0].color})`}});return le(()=>{o.value=yc(i)}),e({el:i}),(s,f)=>(A(),R("div",{class:"note",ref_key:"el",ref:i,style:vt({...a.value,width:o.value})},null,4))}},Kc=ht(Xc,[["__scopeId","data-v-4fff4b26"]]),Vr={default:Vc,entity:Bc,graph:$i,image:Yc,note:Kc};function jc(t){return Vr[t]??Vr.default}var Qc=4,Jc=.001,tf=1e-7,ef=10,_e=11,Ue=1/(_e-1),nf=typeof Float32Array=="function";function Ai(t,e){return 1-3*e+3*t}function Ni(t,e){return 3*e-6*t}function ki(t){return 3*t}function ln(t,e,n){return((Ai(e,n)*t+Ni(e,n))*t+ki(e))*t}function Ti(t,e,n){return 3*Ai(e,n)*t*t+2*Ni(e,n)*t+ki(e)}function rf(t,e,n,r,i){var o,a,s=0;do a=e+(n-e)/2,o=ln(a,r,i)-t,o>0?n=a:e=a;while(Math.abs(o)>tf&&++s<ef);return a}function of(t,e,n,r){for(var i=0;i<Qc;++i){var o=Ti(e,n,r);if(o===0)return e;var a=ln(e,n,r)-t;e-=a/o}return e}function af(t){return t}var sf=function(e,n,r,i){if(!(0<=e&&e<=1&&0<=r&&r<=1))throw new Error("bezier x values must be in [0, 1] range");if(e===n&&r===i)return af;for(var o=nf?new Float32Array(_e):new Array(_e),a=0;a<_e;++a)o[a]=ln(a*Ue,e,r);function s(f){for(var u=0,l=1,h=_e-1;l!==h&&o[l]<=f;++l)u+=Ue;--l;var d=(f-o[l])/(o[l+1]-o[l]),p=u+d*Ue,x=Ti(p,e,r);return x>=Jc?of(f,p,e,r):x===0?p:rf(f,u,u+Ue,e,r)}return function(u){return u===0?0:u===1?1:ln(s(u),n,i)}};const uf=Kr(sf);var cn={exports:{}};cn.exports;(function(t,e){var n=200,r="__lodash_hash_undefined__",i=1,o=2,a=9007199254740991,s="[object Arguments]",f="[object Array]",u="[object AsyncFunction]",l="[object Boolean]",h="[object Date]",d="[object Error]",p="[object Function]",x="[object GeneratorFunction]",v="[object Map]",m="[object Number]",y="[object Null]",L="[object Object]",S="[object Promise]",M="[object Proxy]",B="[object RegExp]",H="[object Set]",K="[object String]",Y="[object Symbol]",J="[object Undefined]",W="[object WeakMap]",E="[object ArrayBuffer]",F="[object DataView]",V="[object Float32Array]",_="[object Float64Array]",N="[object Int8Array]",C="[object Int16Array]",k="[object Int32Array]",z="[object Uint8Array]",P="[object Uint8ClampedArray]",w="[object Uint16Array]",$="[object Uint32Array]",I=/[\\^$.*+?()[\]{}|]/g,X=/^\[object .+?Constructor\]$/,q=/^(?:0|[1-9]\d*)$/,Z={};Z[V]=Z[_]=Z[N]=Z[C]=Z[k]=Z[z]=Z[P]=Z[w]=Z[$]=!0,Z[s]=Z[f]=Z[E]=Z[l]=Z[F]=Z[h]=Z[d]=Z[p]=Z[v]=Z[m]=Z[L]=Z[B]=Z[H]=Z[K]=Z[W]=!1;var at=typeof Fe=="object"&&Fe&&Fe.Object===Object&&Fe,ut=typeof self=="object"&&self&&self.Object===Object&&self,tt=at||ut||Function("return this")(),ne=e&&!e.nodeType&&e,Jn=ne&&!0&&t&&!t.nodeType&&t,tr=Jn&&Jn.exports===ne,yn=tr&&at.process,er=function(){try{return yn&&yn.binding&&yn.binding("util")}catch{}}(),nr=er&&er.isTypedArray;function zi(c,g){for(var b=-1,T=c==null?0:c.length,et=0,U=[];++b<T;){var it=c[b];g(it,b,c)&&(U[et++]=it)}return U}function Di(c,g){for(var b=-1,T=g.length,et=c.length;++b<T;)c[et+b]=g[b];return c}function Pi(c,g){for(var b=-1,T=c==null?0:c.length;++b<T;)if(g(c[b],b,c))return!0;return!1}function Oi(c,g){for(var b=-1,T=Array(c);++b<c;)T[b]=g(b);return T}function Ri(c){return function(g){return c(g)}}function Bi(c,g){return c.has(g)}function Fi(c,g){return c==null?void 0:c[g]}function Zi(c){var g=-1,b=Array(c.size);return c.forEach(function(T,et){b[++g]=[et,T]}),b}function Hi(c,g){return function(b){return c(g(b))}}function Gi(c){var g=-1,b=Array(c.size);return c.forEach(function(T){b[++g]=T}),b}var Vi=Array.prototype,Ui=Function.prototype,Ee=Object.prototype,mn=tt["__core-js_shared__"],rr=Ui.toString,St=Ee.hasOwnProperty,ir=function(){var c=/[^.]+$/.exec(mn&&mn.keys&&mn.keys.IE_PROTO||"");return c?"Symbol(src)_1."+c:""}(),or=Ee.toString,qi=RegExp("^"+rr.call(St).replace(I,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ar=tr?tt.Buffer:void 0,Ie=tt.Symbol,sr=tt.Uint8Array,ur=Ee.propertyIsEnumerable,Wi=Vi.splice,Vt=Ie?Ie.toStringTag:void 0,lr=Object.getOwnPropertySymbols,Yi=ar?ar.isBuffer:void 0,Xi=Hi(Object.keys,Object),_n=re(tt,"DataView"),fe=re(tt,"Map"),xn=re(tt,"Promise"),wn=re(tt,"Set"),bn=re(tt,"WeakMap"),he=re(Object,"create"),Ki=Wt(_n),ji=Wt(fe),Qi=Wt(xn),Ji=Wt(wn),to=Wt(bn),cr=Ie?Ie.prototype:void 0,Cn=cr?cr.valueOf:void 0;function Ut(c){var g=-1,b=c==null?0:c.length;for(this.clear();++g<b;){var T=c[g];this.set(T[0],T[1])}}function eo(){this.__data__=he?he(null):{},this.size=0}function no(c){var g=this.has(c)&&delete this.__data__[c];return this.size-=g?1:0,g}function ro(c){var g=this.__data__;if(he){var b=g[c];return b===r?void 0:b}return St.call(g,c)?g[c]:void 0}function io(c){var g=this.__data__;return he?g[c]!==void 0:St.call(g,c)}function oo(c,g){var b=this.__data__;return this.size+=this.has(c)?0:1,b[c]=he&&g===void 0?r:g,this}Ut.prototype.clear=eo,Ut.prototype.delete=no,Ut.prototype.get=ro,Ut.prototype.has=io,Ut.prototype.set=oo;function Tt(c){var g=-1,b=c==null?0:c.length;for(this.clear();++g<b;){var T=c[g];this.set(T[0],T[1])}}function ao(){this.__data__=[],this.size=0}function so(c){var g=this.__data__,b=De(g,c);if(b<0)return!1;var T=g.length-1;return b==T?g.pop():Wi.call(g,b,1),--this.size,!0}function uo(c){var g=this.__data__,b=De(g,c);return b<0?void 0:g[b][1]}function lo(c){return De(this.__data__,c)>-1}function co(c,g){var b=this.__data__,T=De(b,c);return T<0?(++this.size,b.push([c,g])):b[T][1]=g,this}Tt.prototype.clear=ao,Tt.prototype.delete=so,Tt.prototype.get=uo,Tt.prototype.has=lo,Tt.prototype.set=co;function qt(c){var g=-1,b=c==null?0:c.length;for(this.clear();++g<b;){var T=c[g];this.set(T[0],T[1])}}function fo(){this.size=0,this.__data__={hash:new Ut,map:new(fe||Tt),string:new Ut}}function ho(c){var g=Pe(this,c).delete(c);return this.size-=g?1:0,g}function po(c){return Pe(this,c).get(c)}function go(c){return Pe(this,c).has(c)}function vo(c,g){var b=Pe(this,c),T=b.size;return b.set(c,g),this.size+=b.size==T?0:1,this}qt.prototype.clear=fo,qt.prototype.delete=ho,qt.prototype.get=po,qt.prototype.has=go,qt.prototype.set=vo;function ze(c){var g=-1,b=c==null?0:c.length;for(this.__data__=new qt;++g<b;)this.add(c[g])}function yo(c){return this.__data__.set(c,r),this}function mo(c){return this.__data__.has(c)}ze.prototype.add=ze.prototype.push=yo,ze.prototype.has=mo;function Ot(c){var g=this.__data__=new Tt(c);this.size=g.size}function _o(){this.__data__=new Tt,this.size=0}function xo(c){var g=this.__data__,b=g.delete(c);return this.size=g.size,b}function wo(c){return this.__data__.get(c)}function bo(c){return this.__data__.has(c)}function Co(c,g){var b=this.__data__;if(b instanceof Tt){var T=b.__data__;if(!fe||T.length<n-1)return T.push([c,g]),this.size=++b.size,this;b=this.__data__=new qt(T)}return b.set(c,g),this.size=b.size,this}Ot.prototype.clear=_o,Ot.prototype.delete=xo,Ot.prototype.get=wo,Ot.prototype.has=bo,Ot.prototype.set=Co;function Lo(c,g){var b=Oe(c),T=!b&&Bo(c),et=!b&&!T&&Ln(c),U=!b&&!T&&!et&&_r(c),it=b||T||et||U,st=it?Oi(c.length,String):[],lt=st.length;for(var rt in c)St.call(c,rt)&&!(it&&(rt=="length"||et&&(rt=="offset"||rt=="parent")||U&&(rt=="buffer"||rt=="byteLength"||rt=="byteOffset")||zo(rt,lt)))&&st.push(rt);return st}function De(c,g){for(var b=c.length;b--;)if(gr(c[b][0],g))return b;return-1}function Mo(c,g,b){var T=g(c);return Oe(c)?T:Di(T,b(c))}function de(c){return c==null?c===void 0?J:y:Vt&&Vt in Object(c)?Eo(c):Ro(c)}function fr(c){return pe(c)&&de(c)==s}function hr(c,g,b,T,et){return c===g?!0:c==null||g==null||!pe(c)&&!pe(g)?c!==c&&g!==g:So(c,g,b,T,hr,et)}function So(c,g,b,T,et,U){var it=Oe(c),st=Oe(g),lt=it?f:Rt(c),rt=st?f:Rt(g);lt=lt==s?L:lt,rt=rt==s?L:rt;var gt=lt==L,xt=rt==L,ct=lt==rt;if(ct&&Ln(c)){if(!Ln(g))return!1;it=!0,gt=!1}if(ct&&!gt)return U||(U=new Ot),it||_r(c)?dr(c,g,b,T,et,U):ko(c,g,lt,b,T,et,U);if(!(b&i)){var mt=gt&&St.call(c,"__wrapped__"),_t=xt&&St.call(g,"__wrapped__");if(mt||_t){var Bt=mt?c.value():c,Et=_t?g.value():g;return U||(U=new Ot),et(Bt,Et,b,T,U)}}return ct?(U||(U=new Ot),To(c,g,b,T,et,U)):!1}function $o(c){if(!mr(c)||Po(c))return!1;var g=vr(c)?qi:X;return g.test(Wt(c))}function Ao(c){return pe(c)&&yr(c.length)&&!!Z[de(c)]}function No(c){if(!Oo(c))return Xi(c);var g=[];for(var b in Object(c))St.call(c,b)&&b!="constructor"&&g.push(b);return g}function dr(c,g,b,T,et,U){var it=b&i,st=c.length,lt=g.length;if(st!=lt&&!(it&&lt>st))return!1;var rt=U.get(c);if(rt&&U.get(g))return rt==g;var gt=-1,xt=!0,ct=b&o?new ze:void 0;for(U.set(c,g),U.set(g,c);++gt<st;){var mt=c[gt],_t=g[gt];if(T)var Bt=it?T(_t,mt,gt,g,c,U):T(mt,_t,gt,c,g,U);if(Bt!==void 0){if(Bt)continue;xt=!1;break}if(ct){if(!Pi(g,function(Et,Yt){if(!Bi(ct,Yt)&&(mt===Et||et(mt,Et,b,T,U)))return ct.push(Yt)})){xt=!1;break}}else if(!(mt===_t||et(mt,_t,b,T,U))){xt=!1;break}}return U.delete(c),U.delete(g),xt}function ko(c,g,b,T,et,U,it){switch(b){case F:if(c.byteLength!=g.byteLength||c.byteOffset!=g.byteOffset)return!1;c=c.buffer,g=g.buffer;case E:return!(c.byteLength!=g.byteLength||!U(new sr(c),new sr(g)));case l:case h:case m:return gr(+c,+g);case d:return c.name==g.name&&c.message==g.message;case B:case K:return c==g+"";case v:var st=Zi;case H:var lt=T&i;if(st||(st=Gi),c.size!=g.size&&!lt)return!1;var rt=it.get(c);if(rt)return rt==g;T|=o,it.set(c,g);var gt=dr(st(c),st(g),T,et,U,it);return it.delete(c),gt;case Y:if(Cn)return Cn.call(c)==Cn.call(g)}return!1}function To(c,g,b,T,et,U){var it=b&i,st=pr(c),lt=st.length,rt=pr(g),gt=rt.length;if(lt!=gt&&!it)return!1;for(var xt=lt;xt--;){var ct=st[xt];if(!(it?ct in g:St.call(g,ct)))return!1}var mt=U.get(c);if(mt&&U.get(g))return mt==g;var _t=!0;U.set(c,g),U.set(g,c);for(var Bt=it;++xt<lt;){ct=st[xt];var Et=c[ct],Yt=g[ct];if(T)var xr=it?T(Yt,Et,ct,g,c,U):T(Et,Yt,ct,c,g,U);if(!(xr===void 0?Et===Yt||et(Et,Yt,b,T,U):xr)){_t=!1;break}Bt||(Bt=ct=="constructor")}if(_t&&!Bt){var Re=c.constructor,Be=g.constructor;Re!=Be&&"constructor"in c&&"constructor"in g&&!(typeof Re=="function"&&Re instanceof Re&&typeof Be=="function"&&Be instanceof Be)&&(_t=!1)}return U.delete(c),U.delete(g),_t}function pr(c){return Mo(c,Ho,Io)}function Pe(c,g){var b=c.__data__;return Do(g)?b[typeof g=="string"?"string":"hash"]:b.map}function re(c,g){var b=Fi(c,g);return $o(b)?b:void 0}function Eo(c){var g=St.call(c,Vt),b=c[Vt];try{c[Vt]=void 0;var T=!0}catch{}var et=or.call(c);return T&&(g?c[Vt]=b:delete c[Vt]),et}var Io=lr?function(c){return c==null?[]:(c=Object(c),zi(lr(c),function(g){return ur.call(c,g)}))}:Go,Rt=de;(_n&&Rt(new _n(new ArrayBuffer(1)))!=F||fe&&Rt(new fe)!=v||xn&&Rt(xn.resolve())!=S||wn&&Rt(new wn)!=H||bn&&Rt(new bn)!=W)&&(Rt=function(c){var g=de(c),b=g==L?c.constructor:void 0,T=b?Wt(b):"";if(T)switch(T){case Ki:return F;case ji:return v;case Qi:return S;case Ji:return H;case to:return W}return g});function zo(c,g){return g=g??a,!!g&&(typeof c=="number"||q.test(c))&&c>-1&&c%1==0&&c<g}function Do(c){var g=typeof c;return g=="string"||g=="number"||g=="symbol"||g=="boolean"?c!=="__proto__":c===null}function Po(c){return!!ir&&ir in c}function Oo(c){var g=c&&c.constructor,b=typeof g=="function"&&g.prototype||Ee;return c===b}function Ro(c){return or.call(c)}function Wt(c){if(c!=null){try{return rr.call(c)}catch{}try{return c+""}catch{}}return""}function gr(c,g){return c===g||c!==c&&g!==g}var Bo=fr(function(){return arguments}())?fr:function(c){return pe(c)&&St.call(c,"callee")&&!ur.call(c,"callee")},Oe=Array.isArray;function Fo(c){return c!=null&&yr(c.length)&&!vr(c)}var Ln=Yi||Vo;function Zo(c,g){return hr(c,g)}function vr(c){if(!mr(c))return!1;var g=de(c);return g==p||g==x||g==u||g==M}function yr(c){return typeof c=="number"&&c>-1&&c%1==0&&c<=a}function mr(c){var g=typeof c;return c!=null&&(g=="object"||g=="function")}function pe(c){return c!=null&&typeof c=="object"}var _r=nr?Ri(nr):Ao;function Ho(c){return Fo(c)?Lo(c):No(c)}function Go(){return[]}function Vo(){return!1}t.exports=Zo})(cn,cn.exports);var lf=cn.exports;const cf=Kr(lf),we=+getComputedStyle(document.documentElement).getPropertyValue("--transition").replace(/(.+)ms/,(t,e)=>e).replace(/(.+)s/,(t,e)=>e*1e3),Rn=+getComputedStyle(document.documentElement).getPropertyValue("--spacing").replace(/px$/,""),ff={__name:"BaseInterpolate",props:{props:Object,duration:{type:Number,default:we},delay:{type:Number,default:0}},setup(t){const e=t,n=j(e.props);let r=null;const i=uf(.25,.1,.25,1);let o=rn(null,e.props);zt(()=>e.props,(s,f)=>{cf(s,f)||(o=rn(n.value,e.props),r=null,requestAnimationFrame(a))},{deep:!1});function a(s){if(e.duration===0)return n.value={...e.props};r===null&&(r=s);const f=Math.max(Math.min((s-r-e.delay)/e.duration,1),0);n.value={...o(i(f))},f<1&&requestAnimationFrame(a)}return(s,f)=>Xr(s.$slots,"default",Xo(Ko(n.value)))}},hf={class:"node-wrapper"},df={__name:"GraphNode",props:{id:String,view:String,position:Object,graph:[String,Boolean]},setup(t){const e=t,n=jr();Ae();const r=Lt(),i=ce(),o=Qn(),a=Zn(),s=Gt(),f=ee(),u=Ne(),l=Qr(),h=vc(),d=fn(),p=j(null),x=D(()=>r.data.nodes[e.id]),v=D(()=>({transform:`translate(${e.position.x+i.offset.x}px, ${e.position.y+i.offset.y}px) translate(-50%, -50%)`})),m=D(()=>jc(x.value.type)),y=D(()=>p.value.el??p.value.$el),L=D(()=>r.graphs.filter(E=>Object.prototype.hasOwnProperty.call(E.allocations??{},e.id))),S=D(()=>x.value.inheritDisplay?o.inheritStateFromNeighbor(e.id):o.states[e.id]),M=D(()=>{var E,F,V,_;return(_=(V=(F=(E=r.data.nodes)==null?void 0:E[e.graph])==null?void 0:F.allocations)==null?void 0:V[e.id])==null?void 0:_.locked}),B=new ResizeObserver(E=>{for(const F of E)F.contentRect});function H(E){!f.edit||E.metaKey?n.push({name:"graph",params:{type:x.value.type,id:e.id}}):h.connecting?h.close(e.id):d.mode==="add-edge"?h.open(e.id,"→",e.graph):d.mode==="display-blur"?d.setDisplay(e.id,"hide",e.graph):d.mode==="display-default"?d.setDisplay(e.id,"default",e.graph):d.mode==="display-highlight"?d.setDisplay(e.id,"highlight",e.graph):d.mode==="display-unset"&&d.setDisplay(e.id,null,e.graph)}function K(){f.edit&&l.open(e.id,"node")}function Y(E){if(!f.edit||e.view!=="diagram"||E.button!==0||M.value)return;E.stopPropagation();const F={x:E.x,y:E.y},V={x:r.data.nodes[e.graph].allocations[e.id].x,y:r.data.nodes[e.graph].allocations[e.id].y},_=new AbortController;window.addEventListener("mousemove",C=>{const k={x:(C.x-F.x)/i.transform.k,y:(C.y-F.y)/i.transform.k},z=C.shiftKey?.5:20,P=Math.round((V.x+k.x)/z)*z,w=Math.round((V.y+k.y)/z)*z;r.data.nodes[e.graph].allocations[e.id].x=P,r.data.nodes[e.graph].allocations[e.id].y=w},{signal:_.signal}),window.addEventListener("mouseup",()=>{N()},{once:!0,signal:_.signal}),window.addEventListener("keydown",C=>{C.key==="Escape"&&N()},{signal:_.signal});function N(){_.abort()}}function J(E,F){return E?[F]:[]}function W(E){f.edit&&(E.preventDefault(),E.stopPropagation(),u.open(vn,[...J(e.view==="diagram",{label:"delete",action:()=>{r.deleteNode(e.id,e.graph)}}),{label:"edit",action:()=>{l.open(e.id,"node")}},...J(e.view==="diagram",{label:"→",action:()=>{e.view==="diagram"&&h.open(e.id,"→",e.graph)}}),...J(e.view==="diagram",{label:M.value?"unlock":"lock",action:()=>{r.data.nodes[e.graph].allocations[e.id].locked=!M.value}}),{label:"log",action:()=>{console.log(e.id,r.data.nodes[e.graph].allocations[e.id])}}],{x:E.x,y:E.y}))}return zt(()=>[e.position.y,e.position.x],()=>{i.nodes[e.id]={...i.nodes[e.id],x:e.position.x,y:e.position.y}}),le(()=>{B.observe(y.value)}),Fn(()=>{y.value!=null&&B.unobserve(y.value),delete i.nodes[e.id]}),(E,F)=>{var V,_;return A(),R("div",hf,[G("div",{style:vt(v.value)},[(A(),ot(jo(m.value),{ref_key:"componentRef",ref:p,id:t.id,class:At(["node",[S.value,t.view,`mode-${O(d).mode}`,{"user-active":!O(a).inactivityShort||!O(s).playing,edit:O(f).edit,locked:M.value,exact:(_=(V=O(o).exactMarker)==null?void 0:V.states)==null?void 0:_.hasOwnProperty(t.id)}]]),"no-style":v.value,node:x.value,occurances:L.value,position:t.position,onClick:H,onDblclick:Ht(K,["stop"]),onMousedown:Y,onContextmenu:W},null,40,["id","class","no-style","node","occurances","position"]))],4)])}}},pf=ht(df,[["__scopeId","data-v-3a90b1e0"]]);function Ur(t,e,n,r,i,o,a,s,f){const u=i+a,l=o+s,h=i+f,d=o+f,p=i+a-f,x=o+s-f,v=[[i,x,i,d,i,o],[h,o,p,o,u,o],[u,d,u,x,u,l],[p,l,h,l,i,l]],m=[[h,d,Math.PI,Math.PI*1.5],[p,d,Math.PI*1.5,Math.PI*2],[p,x,0,Math.PI*.5],[h,x,Math.PI*.5,Math.PI]];let y=[];return v.forEach((L,S)=>{const[M,B,H,K]=L,[Y,J,W,E]=m[S];mf(Y,J,f,t,e,n,r).filter(V=>{const _=vf(yf(Y,J,V[0],V[1]));return _>W&&_<E}).forEach(V=>y.push({point:V,anchor:S*2+1}));const F=gf(t,e,n,r,M,B,H,K);F&&y.push({point:F,anchor:S*2})}),y}function gf(t,e,n,r,i,o,a,s){const f=(s-o)*(n-t)-(a-i)*(r-e),u=(a-i)*(e-o)-(s-o)*(t-i),l=(n-t)*(e-o)-(r-e)*(t-i);if(f===0)return void 0;const h=u/f,d=l/f;if(h>=0&&h<=1&&d>=0&&d<=1)return[t+h*(n-t),e+h*(r-e)]}function vf(t){return t-Math.PI*2*Math.floor(t/(Math.PI*2))}function yf(t,e,n,r){return Math.atan2(r-e,n-t)}function mf(t,e,n,r,i,o,a){var s,f,u,l,h,d,p,x,v=[o-r,a-i],m=[r-t,i-e];return s=v[0]*m[0]+v[1]*m[1],f=2*(v[0]*v[0]+v[1]*v[1]),s*=-2,u=Math.sqrt(s*s-2*f*(m[0]*m[0]+m[1]*m[1]-n*n)),isNaN(u)?[]:(l=(s-u)/f,h=(s+u)/f,p=[],x=[],d=[],l<=1&&l>=0&&(p[0]=r+v[0]*l,p[1]=i+v[1]*l,d[0]=p),h<=1&&h>=0&&(x[0]=r+v[0]*h,x[1]=i+v[1]*h,d[d.length]=x),d)}const _f=["id"],xf=["id"],wf=["d"],bf=["d","marker-end","marker-start"],Cf=["x","y"],Lf=["x","y"],Mf={__name:"GraphEdge",props:{edge:Object,view:String},setup(t){const e=ce(),n=Qn(),r=Zn(),i=Gt(),o=Lt(),a=ee(),s=Qr(),f=Ne(),u=Ae(),l=t,h=D(()=>u.params.type!=="graph"),d=D(()=>e.nodes[l.edge.nodes[0]]),p=D(()=>e.nodes[l.edge.nodes[1]]),x=D(()=>{var F;const E=(F=o.data.nodes[l.edge.graph])==null?void 0:F.color;return{"--graph-accent":E?`var(--${E})`:null}}),v=D(()=>n.inheritStateFromNodes(l.edge.nodes)),m=D(()=>{if(d.value==null||p.value==null)return;const E=Rn,F=Rn,V=d.value.width+E,_=d.value.height+E,N=p.value.width+E,C=p.value.height+E,k=Ur(d.value.x,d.value.y,p.value.x,p.value.y,d.value.x-V/2,d.value.y-_/2,V,_,Math.min(F,_/2-.1))[0],z=Ur(d.value.x,d.value.y,p.value.x,p.value.y,p.value.x-N/2,p.value.y-C/2,N,C,Math.min(F,C/2-.1))[0];if(k==null||z==null)return;const P={x:k.point[0]+e.offset.x,y:k.point[1]+e.offset.y},w={x:z.point[0]+e.offset.x,y:z.point[1]+e.offset.y},$={x:(P.x+w.x)/2,y:(P.y+w.y)/2};if(h.value)return[P,$,$,w];const I=[{x:-1,y:0},{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1},{x:1,y:0},{x:1,y:1},{x:0,y:1},{x:-1,y:1}];return[P,{x:P.x+I[k.anchor].x*100,y:P.y+I[k.anchor].y*100},{x:w.x+I[z.anchor].x*100,y:w.y+I[z.anchor].y*100},w]}),y=D(()=>{if(m.value!=null)return`M${m.value.map((E,F)=>`${F===1?"C":""}${E.x},${E.y}`).join(" ")}`}),L=D(()=>m.value==null?[]:{x:(m.value[0].x+m.value[m.value.length-1].x)/2,y:(m.value[0].y+m.value[m.value.length-1].y)/2}),S=D(()=>l.edge.nodes.join("-")),M=D(()=>`url('#marker-${S.value}')`),B=D(()=>`url('#marker-${S.value}-alt')`),H=D(()=>(l.edge.arrow==="→"||l.edge.arrow==="↔")&&M.value),K=D(()=>(l.edge.arrow==="←"||l.edge.arrow==="↔")&&B.value);function Y(E){if(!E.metaKey)return;E.stopPropagation(),E.preventDefault();const F=[null,"→","←","↔"],V=Math.max(F.indexOf(l.edge.arrow),0);o.data.edges.find(_=>_.id===l.edge.id).arrow=F[(V+1)%F.length]}function J(E){!a.edit||E.metaKey||s.open(l.edge.id,"edge")}function W(E){a.edit&&(E.preventDefault(),E.stopPropagation(),f.open(vn,[{label:"delete",action:()=>{o.data.edges=o.data.edges.filter(F=>F.id!==l.edge.id)}},{label:"edit",action:()=>{s.open(l.edge.id,"edge")}}],{x:E.x,y:E.y}))}return(E,F)=>(A(),R("g",{class:At(["edge",[v.value,t.view,{"user-active":!O(r).inactivityShort||!O(i).playing}]]),style:vt(x.value)},[G("defs",null,[G("marker",{id:`marker-${S.value}`,markerWidth:"10",markerHeight:"20",refX:"10",refY:"10",orient:"auto"},F[0]||(F[0]=[G("path",{d:"M2,6.5 L10,10 L2,13.5"},null,-1)]),8,_f),G("marker",{id:`marker-${S.value}-alt`,markerWidth:"10",markerHeight:"20",refX:"00",refY:"10",orient:"auto"},F[1]||(F[1]=[G("path",{d:"M8,6.5 L0,10 L8,13.5"},null,-1)]),8,xf)]),Q(ff,{props:{d:y.value,...L.value},delay:0,duration:O(a).edit?0:O(we)},{default:nt(V=>[O(a).edit?(A(),R("path",{key:0,class:"edit",d:V.d,onDblclick:Ht(J,["stop"]),onContextmenu:W,onClick:Y},null,40,wf)):wt("",!0),G("path",{d:V.d,"marker-end":H.value,"marker-start":K.value},null,8,bf),G("text",{class:At(["shadow",{edit:O(a).edit}]),x:V.x,y:V.y,onDblclick:Ht(J,["stop"]),onContextmenu:W,onClick:Y},[Q(Qe,{text:t.edge.label},null,8,["text"])],42,Cf),G("text",{x:V.x,y:V.y},[Q(Qe,{text:t.edge.label},null,8,["text"])],8,Lf)]),_:1},8,["props","duration"])],6))}},Sf=ht(Mf,[["__scopeId","data-v-56a16983"]]),qe={__name:"ContextMenuSearch",props:{context:{type:Object,default:()=>({nodeType:"entity"})}},setup(t){const e=Lt(),n=Ne(),r=ce();function i(o){e.data.nodes[e.nodeId].allocations==null&&(e.data.nodes[e.nodeId].allocations={}),e.data.nodes[e.nodeId].allocations[o]={x:(n.offset.x-r.transform.x)/r.transform.k,y:(n.offset.y-r.transform.y)/r.transform.k}}return(o,a)=>(A(),ot(Qo,{onSelectItem:i,context:t.context},null,8,["context"]))}},$f=["d"],Af={__name:"TheGraph",setup(t){const e=Ae(),n=jr(),r=Lt();Jo();const i=Qn(),o=Zn(),a=Gt(),s=ce(),f=ee(),u=Ne(),l=fn(),h=j([]),d=j(null),p=j(null),x=j(null),v=j(null),m=D(()=>e.params.id),y=j(r.data.nodes[m.value]),L=D(()=>e.params.type==="graph"?"diagram":"network"),S=D(()=>`translate(${s.transform.x}px, ${s.transform.y}px) scale(${s.transform.k})`),M=D(()=>{if(h.value==null)return;if(i.bounds!=null)return{x1:i.bounds.x1+s.offset.x,y1:i.bounds.y1+s.offset.y,x2:i.bounds.x2+s.offset.x,y2:i.bounds.y2+s.offset.y};const w=Object.values(h.value),$=w.map(({x:Z})=>Z),I=w.map(({y:Z})=>Z),X=200,q=100;return{x1:Math.min(...$)-X+s.offset.x,y1:Math.min(...I)-q+s.offset.y,x2:Math.max(...$)+X+s.offset.x,y2:Math.max(...I)+q+s.offset.y}}),B=D(()=>{const w=Object.keys(h.value??{});return r.data.edges.filter($=>w.includes($.nodes[0])&&w.includes($.nodes[1])&&($.graph===m.value||y.value.type!=="graph"))}),H=D(()=>Object.keys(h.value??{}).sort()),K=D(()=>{if(y.value.color!=null)return{"--graph-accent":`var(--${y.value.color})`}}),Y=D(()=>{var q;if((((q=i.exactMarker)==null?void 0:q.bounds)==null&&v.value)==null)return;const{x1:w,y1:$,x2:I,y2:X}=v.value||i.exactMarker.bounds;return`M${w+s.offset.x},${$+s.offset.y} L${I+s.offset.x},${$+s.offset.y} L${I+s.offset.x},${X+s.offset.y} L${w+s.offset.x},${X+s.offset.y} Z`});zt([m,()=>r.data],([w],[$])=>{y.value=r.data.nodes[w],J(we,$)}),zt(M,()=>{o.inactivityShort&&E(M.value,we)}),zt(()=>o.inactivityShort,()=>{a.playing&&E(M.value,we)}),zt(()=>o.inactivityLong,()=>{a.playing&&e.name==="graph"&&e.params.type!=="graph"&&a.graphId!=null&&n.push({name:"graph",params:{type:"graph",id:a.graphId}})}),le(()=>{p.value=Ft(d.value),x.value=zl().scaleExtent([.1,1]).on("zoom",w=>{s.transform=w.transform}).filter(w=>{if(l.mode!=="display-frame")return Ce(()=>o.registerActivity()),w.button===0&&!u.show}),p.value.call(x.value),J(0),V.observe(d.value)}),Fn(()=>{d.value!=null&&V.unobserve(d.value)});function J(w,$){if(y.value.type==="graph"){if(h.value=y.value.allocations,$!=null){const I=r.data.nodes[$].type==="graph"?W(r.data.nodes[$].allocations):{x:0,y:0},X=r.data.nodes[$].type==="graph"||h.value[$]==null?W(h.value):h.value[$];s.offset.x=s.offset.x+I.x-X.x,s.offset.y=s.offset.y+I.y-X.y}E(M.value,w)}else h.value=dc(m.value),F(s.offset,w)}function W(w){const $=Object.values(w),I=$.map(({x:tt})=>tt),X=$.map(({y:tt})=>tt),q=Math.min(...I),Z=Math.max(...I),at=Math.min(...X),ut=Math.max(...X);return{x:(q+Z)/2,y:(at+ut)/2}}function E(w,$=0){if(w==null)return;const I={x:w.x2-w.x1,y:w.y2-w.y1},X=d.value.getBoundingClientRect(),q=X.width/I.x,Z=(X.height-Rn*2.7)/I.y,at=Math.min(q,Z),ut=w.x1+I.x/2,tt=w.y1+I.y/2;p.value.transition().duration($).call(x.value.transform,un.translate(X.width/2,X.height/2).scale(at).translate(-ut,-tt))}function F({x:w,y:$},I=0){const X=d.value.getBoundingClientRect();p.value.transition().duration(I).call(x.value.transform,un.translate(X.width/2,X.height/2).scale(1).translate(-w,-$))}const V=new ResizeObserver(w=>{for(const $ of w)$.contentRect&&E(M.value,0)});function _(w){!f.edit||L.value!=="diagram"||(w.preventDefault(),u.open(vn,[{label:"add",action:$=>{$.stopPropagation(),u.open(qe)}},{label:"log",action:()=>{console.log(s.transform,u.offset)}}],{x:w.x,y:w.y}))}function N(w){if(!(!f.edit||L.value!=="diagram"))switch(["add-entity","add-story","add-image"].includes(l.mode)&&w.stopPropagation(),l.mode){case"add-entity":u.open(qe,{nodeType:"entity"},{x:w.x,y:w.y}),l.resetMode();break;case"add-story":u.open(qe,{nodeType:"graph"},{x:w.x,y:w.y}),l.resetMode();break;case"add-image":u.open(qe,{nodeType:"image"},{x:w.x,y:w.y}),l.resetMode();break}}function C(w){if(l.mode==="display-frame"){w.preventDefault(),w.stopPropagation();const $=P(w);v.value={x1:$.x-s.offset.x,y1:$.y-s.offset.y,x2:$.x-s.offset.x,y2:$.y-s.offset.y};const I=new AbortController,X=function(){console.log("reset"),I.abort(),v.value=null};window.addEventListener("keydown",q=>{q.key==="Escape"&&X()},{signal:I.signal}),window.addEventListener("mousemove",q=>{const{x:Z,y:at}=P(q);v.value.x2=Z-s.offset.x,v.value.y2=at-s.offset.y},{signal:I.signal}),window.addEventListener("mouseup",()=>{l.setBounds(v.value,m.value),X(),l.resetMode()},{signal:I.signal})}}function k(w){if(w.preventDefault(),!f.edit||L.value!=="diagram")return;const $=br(w.dataTransfer.getData("text/uri-list")),I=r.nodes.find(q=>q.file===br($));if(I!=null)return z(I.id,w.x,w.y);if(/(.png|.jpe?g|.gif|.webp)$/i.test($)){const q=crypto.randomUUID(),Z={type:"image",file:$,label:{universal:$.replace(/[^:]*:\/?\/?/,"").replace(/\.[^.]+$/,"")}};r.data.nodes[q]=Z,z(q,w.x,w.y)}}function z(w,$,I){r.data.nodes[r.nodeId].allocations[w]=P({x:$,y:I})}function P(w){return{x:(w.x-s.transform.x)/s.transform.k,y:(w.y-s.transform.y)/s.transform.k}}return(w,$)=>(A(),R(jt,null,[G("main",{class:At(["graph",[`mode-${O(l).mode}`,{initializing:O(e).meta.initializeView}]]),ref_key:"zoomElement",ref:d,style:vt(K.value),onContextmenu:_,onClick:N,onMousedown:C,onDrop:k,onDragover:$[0]||($[0]=Ht(()=>{},["prevent"])),onDragenter:$[1]||($[1]=Ht(()=>{},["prevent"]))},[G("div",{class:"nodes",style:vt({transform:S.value})},[Q(wr,{name:"nodes"},{default:nt(()=>[(A(!0),R(jt,null,ae(H.value,I=>(A(),ot(pf,{key:I,id:I,position:h.value[I],view:L.value,graph:L.value==="diagram"&&m.value},null,8,["id","position","view","graph"]))),128))]),_:1})],4),(A(),R("svg",null,[G("g",{style:vt({transform:S.value})},[Q(wr,{name:"edges"},{default:nt(()=>[(A(!0),R(jt,null,ae(B.value,I=>(A(),ot(Sf,{key:I.id,edge:I,view:L.value},null,8,["edge","view"]))),128))]),_:1}),O(f).edit&&Y.value?(A(),R("path",{key:0,d:Y.value,class:"display-bounds"},null,8,$f)):wt("",!0)],4)]))],38),$[2]||($[2]=G("div",{class:"tint"},null,-1))],64))}},Nf=ht(Af,[["__scopeId","data-v-f4ac8e94"]]),kf={class:"icon",width:"45",height:"45",viewBox:"0 0 45 45",xmlns:"http://www.w3.org/2000/svg"};function Tf(t,e){return A(),R("svg",kf,e[0]||(e[0]=[G("path",{d:"M18,15 L20,15 C20.5522847,15 21,15.4477153 21,16 L21,29 C21,29.5522847 20.5522847,30 20,30 L18,30 C17.4477153,30 17,29.5522847 17,29 L17,16 C17,15.4477153 17.4477153,15 18,15 Z M25,15 L27,15 C27.5522847,15 28,15.4477153 28,16 L28,29 C28,29.5522847 27.5522847,30 27,30 L25,30 C24.4477153,30 24,29.5522847 24,29 L24,16 C24,15.4477153 24.4477153,15 25,15 Z",fill:"currentColor","fill-rule":"evenodd"},null,-1)]))}const Ef={name:"base-ControlsPause",render:Tf},If={class:"icon",width:"45",height:"45",viewBox:"0 0 45 45",xmlns:"http://www.w3.org/2000/svg"};function zf(t,e){return A(),R("svg",If,e[0]||(e[0]=[G("polyline",{stroke:"#000000","stroke-width":"2",transform:"matrix(-1 0 0 1 43.5 0)",points:"18.5 16 25 22.5 18.5 29",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)]))}const Df={name:"base-ControlsMarkerPrevious",render:zf},Pf={class:"icon",width:"45",height:"45",viewBox:"0 0 45 45",xmlns:"http://www.w3.org/2000/svg"};function Of(t,e){return A(),R("svg",Pf,e[0]||(e[0]=[G("polyline",{stroke:"#000000","stroke-width":"2",points:"20 16 26.5 22.5 20 29",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)]))}const Rf={name:"base-ControlsMarkerNext",render:Of},Bf={class:"icon",width:"3",height:"45",viewBox:"0 0 3 45",xmlns:"http://www.w3.org/2000/svg"};function Ff(t,e){return A(),R("svg",Bf,e[0]||(e[0]=[G("path",{d:"M2,36.5 C2,36.7761424 1.77614237,37 1.5,37 C1.22385763,37 1,36.7761424 1,36.5 L1,8.5 C1,8.22385763 1.22385763,8 1.5,8 C1.77614237,8 2,8.22385763 2,8.5 L2,36.5 Z",fill:"currentColor",opacity:".25"},null,-1)]))}const Zf={name:"base-SeperatorVertical",render:Ff},Hf={class:"icon",width:"45",height:"45",viewBox:"0 0 45 45",xmlns:"http://www.w3.org/2000/svg"};function Gf(t,e){return A(),R("svg",Hf,e[0]||(e[0]=[G("g",{fill:"none","fill-rule":"evenodd"},[G("path",{d:"M18,14 C18.5522847,14 19,14.4477153 19,15 C19,15.5522847 18.5522847,16 18,16 L17,16 C16.4477153,16 16,16.4477153 16,17 L16,18 C16,18.5522847 15.5522847,19 15,19 C14.4477153,19 14,18.5522847 14,18 L14,17 C14,15.3431458 15.3431458,14 17,14 L18,14 Z M31,18 C31,18.5522847 30.5522847,19 30,19 C29.4477153,19 29,18.5522847 29,18 L29,17 C29,16.4477153 28.5522847,16 28,16 L27,16 C26.4477153,16 26,15.5522847 26,15 C26,14.4477153 26.4477153,14 27,14 L28,14 C29.6568542,14 31,15.3431458 31,17 L31,18 Z M27,31 C26.4477153,31 26,30.5522847 26,30 C26,29.4477153 26.4477153,29 27,29 L28,29 C28.5522847,29 29,28.5522847 29,28 L29,27 C29,26.4477153 29.4477153,26 30,26 C30.5522847,26 31,26.4477153 31,27 L31,28 C31,29.6568542 29.6568542,31 28,31 L27,31 Z M14,27 C14,26.4477153 14.4477153,26 15,26 C15.5522847,26 16,26.4477153 16,27 L16,28 C16,28.5522847 16.4477153,29 17,29 L18,29 C18.5522847,29 19,29.4477153 19,30 C19,30.5522847 18.5522847,31 18,31 L17,31 C15.3431458,31 14,29.6568542 14,28 L14,27 Z",fill:"currentColor","fill-rule":"nonzero"}),G("path",{d:"M23.2071068,15.2071068 L29.7928932,21.7928932 C30.1834175,22.1834175 30.1834175,22.8165825 29.7928932,23.2071068 L23.2071068,29.7928932 C22.8165825,30.1834175 22.1834175,30.1834175 21.7928932,29.7928932 L15.2071068,23.2071068 C14.8165825,22.8165825 14.8165825,22.1834175 15.2071068,21.7928932 L21.7928932,15.2071068 C22.1834175,14.8165825 22.8165825,14.8165825 23.2071068,15.2071068 Z",fill:"currentColor"})],-1)]))}const Vf={name:"base-DisplayDefaultFrame",render:Gf},Uf={class:"icon",width:"45",height:"45",viewBox:"0 0 45 45",xmlns:"http://www.w3.org/2000/svg"};function qf(t,e){return A(),R("svg",Uf,e[0]||(e[0]=[G("path",{d:"M23.2071068,15.2071068 L29.7928932,21.7928932 C30.1834175,22.1834175 30.1834175,22.8165825 29.7928932,23.2071068 L23.2071068,29.7928932 C22.8165825,30.1834175 22.1834175,30.1834175 21.7928932,29.7928932 L15.2071068,23.2071068 C14.8165825,22.8165825 14.8165825,22.1834175 15.2071068,21.7928932 L21.7928932,15.2071068 C22.1834175,14.8165825 22.8165825,14.8165825 23.2071068,15.2071068 Z",fill:"currentColor","fill-rule":"evenodd"},null,-1)]))}const Ei={name:"base-DisplayDefault",render:qf},Wf={class:"icon",width:"45",height:"45",viewBox:"0 0 45 45",xmlns:"http://www.w3.org/2000/svg"};function Yf(t,e){return A(),R("svg",Wf,e[0]||(e[0]=[G("path",{d:"M19,14 C19.5522847,14 20,14.4477153 20,15 C20,15.5522847 19.5522847,16 19,16 L17,16 C16.4477153,16 16,16.4477153 16,17 L16,19 C16,19.5522847 15.5522847,20 15,20 C14.4477153,20 14,19.5522847 14,19 L14,17 C14,15.3431458 15.3431458,14 17,14 L19,14 Z M31,19 C31,19.5522847 30.5522847,20 30,20 C29.4477153,20 29,19.5522847 29,19 L29,17 C29,16.4477153 28.5522847,16 28,16 L26,16 C25.4477153,16 25,15.5522847 25,15 C25,14.4477153 25.4477153,14 26,14 L28,14 C29.6568542,14 31,15.3431458 31,17 L31,19 Z M26,31 C25.4477153,31 25,30.5522847 25,30 C25,29.4477153 25.4477153,29 26,29 L28,29 C28.5522847,29 29,28.5522847 29,28 L29,26 C29,25.4477153 29.4477153,25 30,25 C30.5522847,25 31,25.4477153 31,26 L31,28 C31,29.6568542 29.6568542,31 28,31 L26,31 Z M14,26 C14,25.4477153 14.4477153,25 15,25 C15.5522847,25 16,25.4477153 16,26 L16,28 C16,28.5522847 16.4477153,29 17,29 L19,29 C19.5522847,29 20,29.4477153 20,30 C20,30.5522847 19.5522847,31 19,31 L17,31 C15.3431458,31 14,29.6568542 14,28 L14,26 Z",fill:"currentColor"},null,-1)]))}const Ii={name:"base-DisplayFrame",render:Yf},Xf={key:0,class:"markers"},Kf=["onClick","onMousemove","onContextmenu"],jf={__name:"ControlsProgress",props:{showMarkers:Boolean},setup(t){const e=j(0),n=Lt(),r=Gt(),i=Ne(),o=fn(),a=D(()=>n.data.nodes[r.graphId]),s=D(()=>{const x=`${r.time/r.duration*100}%`;return`linear-gradient(to right, var(--left) ${x}, var(--right) ${x})`});function f(x,v){(v||!r.playing)&&(r.playFrom=r.time=x.offsetX/x.target.getBoundingClientRect().width*r.duration),v&&h()}function u(x){return`${x/r.duration*100}%`}function l(x,v,m){x.stopPropagation(),(m||!r.playing)&&(r.playFrom=r.time=v.time),m&&h()}function h(){e.value=r.time}function d(){r.playFrom=r.time=e.value}function p(x,v,m){x.preventDefault(),x.stopPropagation(),i.open(vn,[{label:"delete",action:()=>{n.data.nodes[r.graphId].marker=n.data.nodes[r.graphId].marker.filter((y,L)=>L!==m)}},{label:"+",remainOpen:!0,action:y=>{y.stopPropagation(),n.data.nodes[r.graphId].marker[m].time+=1}},{label:"-",remainOpen:!0,action:y=>{y.stopPropagation(),n.data.nodes[r.graphId].marker[m].time-=1}},...v.bounds!=null?[{label:"clear bounds",action:()=>{o.setBounds(null,r.graphId,v.time)}}]:[]],{x:x.x,y:x.y})}return(x,v)=>{var m;return A(),R("div",{class:"progress",style:vt({background:s.value}),onClick:v[0]||(v[0]=y=>f(y,!0)),onMousemove:f,onMouseenter:h,onMouseleave:d},[t.showMarkers&&((m=a.value)!=null&&m.marker)?(A(),R("div",Xf,[(A(!0),R(jt,null,ae(a.value.marker,(y,L)=>(A(),R("div",{key:L,class:At(["marker",{active:y.time===O(r).time||y.time===e.value}]),style:vt({left:u(y.time)}),onClick:S=>l(S,y,!0),onMousemove:S=>l(S,y),onContextmenu:S=>p(S,y,L)},[y.bounds&&y.states?(A(),ot(O(Vf),{key:0})):y.states?(A(),ot(O(Ei),{key:1})):(A(),ot(O(Ii),{key:2}))],46,Kf))),128))])):wt("",!0)],36)}}},qr=ht(jf,[["__scopeId","data-v-158acf2c"]]),Qf={__name:"TheControls",setup(t){const e=Lt(),n=Gt(),r=ee(),i=D(()=>e.data.nodes[n.graphId]),o=D(()=>{var l;if(((l=i.value)==null?void 0:l.color)!=null)return{"--graph-accent":`var(--${i.value.color})`}}),a=D(()=>n.playing),s=D(()=>i.value.marker.toSorted((l,h)=>l.time-h.time));function f(){var l;n.playFrom=n.time=((l=s.value.findLast(h=>h.time<n.time))==null?void 0:l.time)??0}function u(){var l;n.playFrom=n.time=((l=s.value.find(h=>h.time>n.time))==null?void 0:l.time)??n.duration}return(l,h)=>(A(),R("section",{class:At(["timeline",{edit:O(r).edit}]),style:vt(o.value)},[O(r).edit?(A(),ot(Yr,{key:0,class:"button-group",horizontal:""},{default:nt(()=>[Q(Mn,{"disable-padding":""},{default:nt(()=>[a.value?(A(),ot(O(Ef),{key:1,onClick:h[1]||(h[1]=d=>O(n).setPlaying=!1)})):(A(),ot(O(Si),{key:0,onClick:h[0]||(h[0]=d=>O(n).setPlaying=!0)}))]),_:1}),Q(Mn,{"disable-padding":""},{default:nt(()=>[Q(O(Df),{onClick:f})]),_:1}),Q(Mn,{"disable-padding":""},{default:nt(()=>[Q(O(Rf),{onClick:u})]),_:1}),Q(O(Zf)),Q(qr,{"show-markers":""})]),_:1})):(A(),ot(qr,{key:1}))],6))}},Jf=ht(Qf,[["__scopeId","data-v-264fb344"]]),t1={class:"icon",width:"45",height:"45",viewBox:"0 0 45 45",xmlns:"http://www.w3.org/2000/svg"};function e1(t,e){return A(),R("svg",t1,e[0]||(e[0]=[G("path",{d:"M18.3994816,13.8517704 L28.7074921,22.4660712 C29.1312774,22.8202243 29.1877255,23.450868 28.8335723,23.8746534 C28.6860759,24.0511499 28.4822444,24.1714042 28.2564291,24.2151501 L25.5073341,24.7477155 C24.9651298,24.8527535 24.6107365,25.377447 24.7157744,25.9196512 C24.7313245,25.9999207 24.7566603,26.0779801 24.7912143,26.1520815 L26.5743353,29.9759967 C26.8077409,30.4765367 26.5911857,31.0715171 26.0906457,31.3049227 L25.184338,31.727541 C24.683798,31.9609466 24.0888175,31.7443914 23.8554119,31.2438515 L22.072291,27.4199363 C21.8388853,26.9193963 21.2439049,26.7028411 20.7433649,26.9362467 C20.6692636,26.9708008 20.5996796,27.0143123 20.5361713,27.0658068 L18.3611183,28.8294093 C17.9321324,29.1772448 17.3023942,29.1114594 16.9545587,28.6824734 C16.8096934,28.5038109 16.7308474,28.2806704 16.7313064,28.0506573 L16.7582326,14.6170974 C16.7593395,14.0648137 17.2079512,13.6179967 17.7602349,13.6191016 C17.9939596,13.6195721 18.220137,13.7018939 18.3994816,13.8517704 Z",fill:"currentColor","fill-rule":"evenodd"},null,-1)]))}const n1={name:"base-CursorDefault",render:e1},r1={class:"icon",width:"45",height:"45",viewBox:"0 0 45 45",xmlns:"http://www.w3.org/2000/svg"};function i1(t,e){return A(),R("svg",r1,e[0]||(e[0]=[G("path",{d:"M32,15 C33.1045695,15 34,15.8954305 34,17 L34,28 C34,29.1045695 33.1045695,30 32,30 L13,30 C11.8954305,30 11,29.1045695 11,28 L11,17 C11,15.8954305 11.8954305,15 13,15 L32,15 Z M32,16 L13,16 C12.4477153,16 12,16.4477153 12,17 L12,28 C12,28.5522847 12.4477153,29 13,29 L32,29 C32.5522847,29 33,28.5522847 33,28 L33,17 C33,16.4477153 32.5522847,16 32,16 Z M23,25 C23.5522847,25 24,25.4477153 24,26 L24,27 C24,27.5522847 23.5522847,28 23,28 L14,28 C13.4477153,28 13,27.5522847 13,27 L13,26 C13,25.4477153 13.4477153,25 14,25 L23,25 Z M31,17 C31.5522847,17 32,17.4477153 32,18 L32,23 C32,23.5522847 31.5522847,24 31,24 L14,24 C13.4477153,24 13,23.5522847 13,23 L13,18 C13,17.4477153 13.4477153,17 14,17 L31,17 Z",fill:"currentColor","fill-rule":"evenodd"},null,-1)]))}const o1={name:"base-AddEntity",render:i1},a1={class:"icon",width:"45",height:"45",viewBox:"0 0 45 45",xmlns:"http://www.w3.org/2000/svg"};function s1(t,e){return A(),R("svg",a1,e[0]||(e[0]=[G("path",{d:"M32,15 C33.1045695,15 34,15.8954305 34,17 L34,28 C34,29.1045695 33.1045695,30 32,30 L13,30 C11.8954305,30 11,29.1045695 11,28 L11,17 C11,15.8954305 11.8954305,15 13,15 L32,15 Z M32,16 L13,16 C12.4477153,16 12,16.4477153 12,17 L12,28 C12,28.5522847 12.4477153,29 13,29 L32,29 C32.5522847,29 33,28.5522847 33,28 L33,17 C33,16.4477153 32.5522847,16 32,16 Z M20.1483417,19.765467 C20.4377927,19.2951091 21.0537395,19.1484551 21.5240974,19.4379061 L25.1160552,21.6483417 C25.2493757,21.730385 25.3615728,21.8425821 25.4436161,21.9759026 C25.7330671,22.4462605 25.5864131,23.0622073 25.1160552,23.3516583 L21.5240974,25.5620939 C21.3664897,25.6590832 21.1850598,25.7104356 21,25.7104356 C20.4477153,25.7104356 20,25.2627203 20,24.7104356 L20,20.2895644 C20,20.1045046 20.0513523,19.9230747 20.1483417,19.765467 Z",fill:"currentColor"},null,-1)]))}const u1={name:"base-AddStory",render:s1},l1={class:"icon",width:"45",height:"45",viewBox:"0 0 45 45",xmlns:"http://www.w3.org/2000/svg"};function c1(t,e){return A(),R("svg",l1,e[0]||(e[0]=[G("path",{d:"M32,15 C33.1045695,15 34,15.8954305 34,17 L34,28 C34,29.1045695 33.1045695,30 32,30 L13,30 C11.8954305,30 11,29.1045695 11,28 L11,17 C11,15.8954305 11.8954305,15 13,15 L32,15 Z M32,16 L13,16 C12.4477153,16 12,16.4477153 12,17 L12,28 C12,28.5522847 12.4477153,29 13,29 L32,29 C32.5522847,29 33,28.5522847 33,28 L33,17 C33,16.4477153 32.5522847,16 32,16 Z M26,22 C27.8346354,21.3884549 29.6692708,21.6183815 31.5040033,22.6896136 C31.8106661,22.8685631 31.9994458,23.1967019 32,23.5517578 L32,27 C32,27.5522847 31.5522847,28 31,28 L14,28 C13.4477153,28 13,27.5522847 13,27 L13,25.9687057 L13.0105961,25.8251331 C13.0818756,25.3451379 13.503213,24.9842004 14,25 L14.4403514,25.0105801 C20.8078896,25.11322 23.2067448,22.9310851 26,22 Z M16.75,18.5 C17.7164983,18.5 18.5,19.2835017 18.5,20.25 C18.5,21.2164983 17.7164983,22 16.75,22 C15.7835017,22 15,21.2164983 15,20.25 C15,19.2835017 15.7835017,18.5 16.75,18.5 Z",fill:"currentColor"},null,-1)]))}const f1={name:"base-AddImage",render:c1},h1={class:"icon",width:"45",height:"45",viewBox:"0 0 45 45",xmlns:"http://www.w3.org/2000/svg"};function d1(t,e){return A(),R("svg",h1,e[0]||(e[0]=[G("path",{d:"M31.0395445,14.6621019 C31.0865261,14.8343676 31.0865261,15.0160709 31.0395445,15.1883367 L29.2261258,21.8375386 C29.0808101,22.3703629 28.531069,22.6845007 27.9982446,22.539185 C27.8303497,22.4933955 27.6773109,22.4045836 27.5542552,22.281528 L25.844,20.5709684 L15.7071068,30.7071068 C15.3165825,31.0976311 14.6834175,31.0976311 14.2928932,30.7071068 C13.9023689,30.3165825 13.9023689,29.6834175 14.2928932,29.2928932 L24.429,19.1559684 L22.718472,17.4457448 C22.3279477,17.0552205 22.3279477,16.4220555 22.718472,16.0315312 C22.8415277,15.9084756 22.9945665,15.8196637 23.1624614,15.7738742 L29.8116633,13.9604555 C30.3444877,13.8151397 30.8942288,14.1292775 31.0395445,14.6621019 Z",fill:"currentColor","fill-rule":"evenodd"},null,-1)]))}const p1={name:"base-AddLink",render:d1},g1={class:"icon",width:"45",height:"3",viewBox:"0 0 45 3",xmlns:"http://www.w3.org/2000/svg"};function v1(t,e){return A(),R("svg",g1,e[0]||(e[0]=[G("path",{d:"M36.5,1 C36.7761424,1 37,1.22385763 37,1.5 C37,1.77614237 36.7761424,2 36.5,2 L8.5,2 C8.22385763,2 8,1.77614237 8,1.5 C8,1.22385763 8.22385763,1 8.5,1 L36.5,1 Z",fill:"currentColor",opacity:".25"},null,-1)]))}const Wr={name:"base-SeperatorHorizontal",render:v1},y1={class:"icon",width:"45",height:"45",viewBox:"0 0 45 45",xmlns:"http://www.w3.org/2000/svg"},m1=["id"],_1=["filter"];function x1(t,e){return A(),R("svg",y1,[G("defs",null,[G("filter",{x:"-34.9%",y:"-34.9%",width:"169.8%",height:"169.8%",filterUnits:"objectBoundingBox",id:t.idMap.a},e[0]||(e[0]=[G("feGaussianBlur",{stdDeviation:"2",in:"SourceGraphic"},null,-1)]),8,m1)]),G("path",{d:"M22.7071068,15.7071068 L29.2928932,22.2928932 C29.6834175,22.6834175 29.6834175,23.3165825 29.2928932,23.7071068 L22.7071068,30.2928932 C22.3165825,30.6834175 21.6834175,30.6834175 21.2928932,30.2928932 L14.7071068,23.7071068 C14.3165825,23.3165825 14.3165825,22.6834175 14.7071068,22.2928932 L21.2928932,15.7071068 C21.6834175,15.3165825 22.3165825,15.3165825 22.7071068,15.7071068 Z",fill:"currentColor",filter:"url(#"+t.idMap.a+")","fill-rule":"evenodd",opacity:".832"},null,8,_1)])}const w1={name:"base-DisplayBlur",render:x1,data(){return{idMap:{a:"uicons-"+Math.random().toString(36).substr(2,10)}}}},b1={class:"icon",width:"45",height:"45",viewBox:"0 0 45 45",xmlns:"http://www.w3.org/2000/svg"};function C1(t,e){return A(),R("svg",b1,e[0]||(e[0]=[G("path",{d:"M17.1464466,27.1464466 L17.8535534,27.8535534 L15.3535534,30.3535534 L14.6464466,29.6464466 L17.1464466,27.1464466 Z M27.8535534,27.1464466 L30.3535534,29.6464466 L29.6464466,30.3535534 L27.1464466,27.8535534 L27.8535534,27.1464466 Z M23.2071068,15.2071068 L29.7928932,21.7928932 C30.1834175,22.1834175 30.1834175,22.8165825 29.7928932,23.2071068 L23.2071068,29.7928932 C22.8165825,30.1834175 22.1834175,30.1834175 21.7928932,29.7928932 L15.2071068,23.2071068 C14.8165825,22.8165825 14.8165825,22.1834175 15.2071068,21.7928932 L21.7928932,15.2071068 C22.1834175,14.8165825 22.8165825,14.8165825 23.2071068,15.2071068 Z M29.6464466,14.6464466 L30.3535534,15.3535534 L27.8535534,17.8535534 L27.1464466,17.1464466 L29.6464466,14.6464466 Z M15.3535534,14.6464466 L17.8535534,17.1464466 L17.1464466,17.8535534 L14.6464466,15.3535534 L15.3535534,14.6464466 Z M20.7868105,14.1744381 L19.8208847,14.4332571 L18.9058212,11.0181936 L19.871747,10.7593745 L20.7868105,14.1744381 Z M26.0941788,33.9818064 L25.128253,34.2406255 L24.2131895,30.8255619 L25.1791153,30.5667429 L26.0941788,33.9818064 Z M25.1791153,14.4332571 L24.2131895,14.1744381 L25.128253,10.7593745 L26.0941788,11.0181936 L25.1791153,14.4332571 Z M19.871747,34.2406255 L18.9058212,33.9818064 L19.8208847,30.5667429 L20.7868105,30.8255619 L19.871747,34.2406255 Z M30.8255619,20.7868105 L30.5667429,19.8208847 L33.9818064,18.9058212 L34.2406255,19.871747 L30.8255619,20.7868105 Z M11.0181936,26.0941788 L10.7593745,25.128253 L14.1744381,24.2131895 L14.4332571,25.1791153 L11.0181936,26.0941788 Z M30.5667429,25.1791153 L30.8255619,24.2131895 L34.2406255,25.128253 L33.9818064,26.0941788 L30.5667429,25.1791153 Z M10.7593745,19.871747 L11.0181936,18.9058212 L14.4332571,19.8208847 L14.1744381,20.7868105 L10.7593745,19.871747 Z",fill:"currentColor","fill-rule":"evenodd"},null,-1)]))}const L1={name:"base-DisplayHighlight",render:C1},M1={class:"icon",width:"45",height:"45",viewBox:"0 0 45 45",xmlns:"http://www.w3.org/2000/svg"};function S1(t,e){return A(),R("svg",M1,e[0]||(e[0]=[G("path",{d:"M30.2071068,14.7928932 C30.5976311,15.1834175 30.5976311,15.8165825 30.2071068,16.2071068 L16.2071068,30.2071068 C15.8165825,30.5976311 15.1834175,30.5976311 14.7928932,30.2071068 C14.4023689,29.8165825 14.4023689,29.1834175 14.7928932,28.7928932 L28.7928932,14.7928932 C29.1834175,14.4023689 29.8165825,14.4023689 30.2071068,14.7928932 Z M27.9142136,19.9142136 L29.7928932,21.7928932 C30.1834175,22.1834175 30.1834175,22.8165825 29.7928932,23.2071068 L23.2071068,29.7928932 C22.8165825,30.1834175 22.1834175,30.1834175 21.7928932,29.7928932 L19.9142136,27.9142136 L27.9142136,19.9142136 Z M23.2071068,15.2071068 L25.0862136,17.0862136 L17.0862136,25.0862136 L15.2071068,23.2071068 C14.8165825,22.8165825 14.8165825,22.1834175 15.2071068,21.7928932 L21.7928932,15.2071068 C22.1834175,14.8165825 22.8165825,14.8165825 23.2071068,15.2071068 Z",fill:"currentColor","fill-rule":"evenodd"},null,-1)]))}const $1={name:"base-DisplayUnset",render:S1},A1={class:"icon",width:"45",height:"45",viewBox:"0 0 45 45",xmlns:"http://www.w3.org/2000/svg"};function N1(t,e){return A(),R("svg",A1,e[0]||(e[0]=[G("path",{d:"M15,30 L30,30 L30,29 L15,29 L15,30 Z M23,15 L23,25.292 L26.6464466,21.6464466 L27.3535534,22.3535534 L22.5,27.2071068 L17.6464466,22.3535534 L18.3535534,21.6464466 L22,25.292 L22,15 L23,15 Z",fill:"currentColor"},null,-1)]))}const k1={name:"base-Export",render:N1},T1={class:"toolbar"},E1={__name:"TheToolbar",setup(t){const e=fn(),n=Lt();return(r,i)=>(A(),R("section",T1,[Q(ta,{modelValue:O(e).mode,"onUpdate:modelValue":i[0]||(i[0]=o=>O(e).mode=o),options:[{value:"default",slot:"default",tooltip:"Select"},{value:"add-entity",slot:"add-entity",tooltip:"add entity"},{value:"add-story",slot:"add-story",tooltip:"add story"},{value:"add-image",slot:"add-image",tooltip:"add image"},{value:"add-edge",slot:"add-edge",tooltip:"add edge"},{disabled:!0,slot:"seperator"},{value:"display-blur",slot:"display-blur",tooltip:"blur"},{value:"display-default",slot:"display-default",tooltip:"default"},{value:"display-highlight",slot:"display-highlight",tooltip:"highlight"},{value:"display-unset",slot:"display-unset",tooltip:"unset"},{value:"display-frame",slot:"display-frame",tooltip:"frame"},{disabled:!0,slot:"seperator2"},{value:"download",slot:"download",tooltip:"download data",action:O(n).exportProject}]},{default:nt(()=>[Q(O(n1))]),"add-entity":nt(()=>[Q(O(o1))]),"add-story":nt(()=>[Q(O(u1))]),"add-image":nt(()=>[Q(O(f1))]),"add-edge":nt(()=>[Q(O(p1))]),seperator:nt(()=>[Q(O(Wr))]),"display-blur":nt(()=>[Q(O(w1))]),"display-default":nt(()=>[Q(O(Ei))]),"display-highlight":nt(()=>[Q(O(L1))]),"display-unset":nt(()=>[Q(O($1))]),"display-frame":nt(()=>[Q(O(Ii))]),seperator2:nt(()=>[Q(O(Wr))]),download:nt(()=>[Q(O(k1))]),_:1},8,["modelValue","options"])]))}},I1=ht(E1,[["__scopeId","data-v-f9fd2ea6"]]),z1={__name:"GraphView",setup(t){const e=Gt(),n=ee(),r=Ae();return(i,o)=>(A(),R("div",{class:At(["graph-view",{"split-screen":O(e).showVideo&&!O(n).pictureInPicture}]),onWheel:o[0]||(o[0]=Ht(()=>{},["prevent"]))},[O(r).meta.hideMenuBar?wt("",!0):(A(),ot(na,{key:0})),Q(Nf),O(e).showVideo?(A(),ot(ea,{key:1})):wt("",!0),Q(Jf),O(n).edit?(A(),ot(I1,{key:2})):wt("",!0)],34))}},B1=ht(z1,[["__scopeId","data-v-bea8aeaf"]]);export{B1 as default};
